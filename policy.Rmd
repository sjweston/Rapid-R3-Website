---
title: "Policy-relevant questions"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

```{r policy-1, echo = F}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
options(knitr.kable.NA = '')
#re-run all the machine learning models?
rerun = FALSE
dontrerun = !rerun
```

```{r policy-2 }
library(conflicted)
library(here)
library(ggpubr)
library(knitr)
library(kableExtra)
conflict_prefer("group_rows", "kableExtra")
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
library(plotly)
library(emmeans)
```

```{r policy-3 }
source(here("Scripts/score data.R")) 
```

```{r policy-4 }
source(here("Functions/pomp.R"))
```

```{r policy-5 }
#pomp scoring
scored = scored %>%
  mutate_at(vars(anxiety, depress, stress, lonely, fussy, fear), pomp) %>%
  rowwise() %>%
  #well-being composite
  mutate(wellbeing = mean(c(anxiety, depress, stress, lonely), na.rm=T),
         wellbeing = 100-wellbeing) %>%
  ungroup() %>%
  mutate(employ_inc1 = case_when(
    unemployed == 0 & poverty150 == 0 ~ "Employed, High Income",
    unemployed == 0 & poverty150 == 1 ~ "Employed, Low Income",
    unemployed == 1 & poverty150 == 0 ~ "Unemployed, High Income",
    unemployed == 1 & poverty150 == 1 ~ "Unemployed, Low Income"))
```


# Representativeness disclaimer

```{r policy-6 }
n_care = length(unique(scored$CaregiverID))
date.min = format(min(as.Date(scored$Date), na.rm = T), format = "%B %d, %Y")
date.max = format(max(as.Date(scored$Date), na.rm = T), format = "%B %d, %Y")
perc = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week))
perc.black = 100*sum(perc$black, na.rm=T)/nrow(perc)
perc.latinx = 100*sum(perc$latinx, na.rm=T)/nrow(perc)
perc.fpl = 100*sum(perc$poverty150, na.rm=T)/nrow(perc)
```

These analyses are based on responses collected from `r papaja::printnum(n_care, format = "d")` caregivers between the dates of `r date.min` and `r date.max`. These caregivers represent a range of voices: `r papaja::printnum(perc.black)`\% are Black/African American, `r papaja::printnum(perc.latinx)`\% are LatinX, and `r papaja::printnum(perc.fpl)`\% live at or below 1.5 times the federal poverty line. Proportions/percentages are calculated based on the item-level response rates, not out of the total sample size. The data for these analyses are *not* weighted.

```{r policy-7 }
source(here("Functions/policy_fun.R"))
```


# Economic Stability

## Receiving public benefits{.tabset}

```{r policy-8 }
pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(!is.na(public_benefits)) %>%
  filter(Week == max(Week)) %>%
  group_by(public_benefits) %>%
  summarize(N = n()) %>%
  as.data.frame()
```


**Are you receiving any sort of public or employment benefits? ex. Federal cash assistance programs such as the Temporary Assistance for Needy Families (TANF), Social Security Income (SSI). OR, Federal-in kind benefit programs such as Medicaid, Food Stamps and Housing.**

Options:

  - Yes $(N = `r pb.table[pb.table$public_benefits == "Yes","N"]`)$
  - No $(N = `r pb.table[pb.table$public_benefits == "No","N"]`)$
  - Didn't Qualify $(N = `r pb.table[pb.table$public_benefits == "Didn't Qualify","N"]`)$
  - Intend to apply $(N = `r pb.table[pb.table$public_benefits == "Intend to apply","N"]`)$
  
_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-9 }
overall_figure(scored, public_benefits)
```


### Over time

```{r policy-10 }
long_plot(scored, public_benefits)
```


### By region

```{r policy-11 }
region_plot(scored, public_benefits)
```


### Black/African American

```{r policy-12 }
bygroup_plot(scored, public_benefits, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_ttest(scored, public_benefits, black)
```

### LatinX

```{r policy-13 }
bygroup_plot(scored, public_benefits, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```
```{r}
bygroup_ttest(scored, public_benefits, latinx)
```
### Low income

```{r policy-14 }
bygroup_plot(scored, public_benefits, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```
```{r}
bygroup_ttest(scored, public_benefits, poverty150)
```

### Income by Employment

```{r policy-15 }
bygroup_plot(scored, public_benefits, employ_inc1)
```

```{r}
bygroup_ttest(scored, public_benefits, employ_inc1)
```


### Related to well-being

```{r policy-16 }
bycont_plot(scored, public_benefits, wellbeing)
```

```{r policy-17, results = 'asis'}
bcont_table(scored, public_benefits, wellbeing)
```




## Which public benefits{.tabset}

```{r policy-18 }
pb_cat.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  ungroup() %>%
  summarize_at(vars(contains("pb_")), .funs = list(sum), na.rm=T)
```


**What types of benefits are you receiving? [Select all that apply.]**

Options:

  - Health/Medical $(N = `r pb_cat.table$pb_health`)$ 
  - Food $(N = `r pb_cat.table$pb_food`)$ 
  - Income (not icluding federal stimulus checks) $(N = `r pb_cat.table$pb_income`)$ 
  - Disability (not military) $(N = `r pb_cat.table$pb_disability`)$
  - Military Pension $(N = `r pb_cat.table$pb_military.pension`)$
  - Military Disability $(N = `r pb_cat.table$pb_military.disabiltiy`)$
  - Military Medical Care $(N = `r pb_cat.table$pb_military.medical`)$
  - Military (any benefit, including pension, disability, etc) $(N = `r pb_cat.table$pb_military`)$
  - Housing Subsidy $(N = `r pb_cat.table$pb_housing`)$
  - Child Care Subsidy $(N = `r pb_cat.table$pb_childcare`)$
  - Other $(N = `r pb_cat.table$pb_other`)$

_Sample sizes are based on caregiver response at the most recent week of participation._

```{r policy-19 }
pb_vars = find_items("pb_", scored)
pb_labels = pb_vars %>%
  gsub("pb_", "", .) %>%
  gsub("\\.", " ", .) %>%
  stringr::str_to_sentence()
```

### Overall

```{r policy-20 }
overall_c_figure(scored, pb_vars, pb_labels)
```

### Over time

```{r policy-21 }
long_c_plot(scored, pb_vars, pb_labels)
```


### By region

```{r policy-22 }
region_c_plot(scored, pb_vars, pb_labels)
```


### Black/African American

```{r policy-23 }
bygroup_c_plot(scored, pb_vars, pb_labels, black, g.levels = c(0,1), g.labels = c("Everyone else", "Black"))
```

```{r  }
bygroup_c_ttest(scored, pb_vars, pb_labels, black)
```


### LatinX

```{r policy-24 }
bygroup_c_plot(scored, pb_vars, pb_labels, latinx, g.levels = c(0,1), g.labels = c("Everyone else", "LatinX"))
```

```{r }
bygroup_c_ttest(scored, pb_vars, pb_labels, latinx)
```


### Low income

```{r policy-25 }
bygroup_c_plot(scored, pb_vars, pb_labels, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r  }
bygroup_c_ttest(scored, pb_vars, pb_labels, poverty150)
```


### Income by Employment

```{r policy-26}
bygroup_c_plot(scored, pb_vars, pb_labels, employ_inc1)
```

```{r }
bygroup_c_ttest(scored, pb_vars, pb_labels, employ_inc1)
```


### Related to well-being

```{r policy-27 }
bycont_c_plot(scored, pb_vars, pb_labels, wellbeing)
```

```{r policy-28, results = 'asis'}
#bcont_table(scored, public_benefits, wellbeing)
```


## Receiving federal stimulus check{.tabset}

```{r policy-29 }
pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  filter(!is.na(federal_stim)) %>%
  group_by(federal_stim) %>%
  summarize(N = n()) %>%
  as.data.frame()
```


**Have  you received a federal stimulus check this year? (Also known as an economic impact payment) (Note: Weeks 3-8 separate this into two questions, one that asks whether participants have received a check (Yes, No, Unsure, Other) and another that asks if they expect to receive one, only presented if they respond "No" to the prior question. These were combined for the present analyses.)**

Options:

  - Yes, I have received a federal stimulus check $(N = `r pb.table[pb.table$federal_stim == "Yes","N"]`)$
  - No, but I expect to receive a federal stimulus check in the near future $(N = `r pb.table[pb.table$federal_stim == "No, expected","N"]`)$
  - No, and I DO NOT expect to receive a federal stimulus check $(N = `r pb.table[pb.table$federal_stim == "No, not expected","N"]`)$
  - Unsure if I will receive a federal stimulus check  $(N = `r pb.table[pb.table$federal_stim == "Unsure","N"]`)$
  - Other  $(N = `r pb.table[pb.table$federal_stim == "Other","N"]`)$
  
_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-30 }
overall_figure(scored, federal_stim)
```


### Over time

```{r policy-31 }
long_plot(scored, federal_stim)
```


### By region

```{r policy-32 }
region_plot(scored, federal_stim)
```


### Black/African American

```{r policy-33 }
bygroup_plot(scored, federal_stim, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_ttest(scored, federal_stim, black)
```

### LatinX

```{r policy-34 }
bygroup_plot(scored, federal_stim, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_ttest(scored, federal_stim, latinx)
```

### Low income

```{r policy-35 }
bygroup_plot(scored, federal_stim, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_ttest(scored, federal_stim, poverty150)
```
### Income by Employment

```{r policy-36}
bygroup_plot(scored, federal_stim, employ_inc1)
```

```{r}
bygroup_ttest(scored, federal_stim, employ_inc1)
```


### Related to well-being

```{r policy-37 }
bycont_plot(scored, federal_stim, wellbeing)
```

```{r policy-38, results = 'asis'}
bcont_table(scored, federal_stim, wellbeing)
```

## Family Income{.tabset}

```{r policy-39 }
pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  filter(!is.na(income_change)) %>%
  group_by(income_change) %>%
  summarize(N = n()) %>%
  as.data.frame()
```


**Which  of the following best describes what has happened to your family income during the coronavirus (COVID-19) pandemic? (Note that in weeks 1-6 and 10-12, there were 5 response options, including decreased very much, decreased somewhat, etc). These were collapsed to allow for assessment across all weeks **

Options:

  - Has decreased $(N = `r pb.table[pb.table$income_change == "Decreased","N"]`)$
  - Has stayed the same $(N = `r pb.table[pb.table$income_change == "Stayed the same","N"]`)$
  - Has increased $(N = `r pb.table[pb.table$income_change == "Increased","N"]`)$
  
_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-40 }
overall_figure(scored, income_change)
```


### Over time

```{r policy-41 }
long_plot(scored, income_change)
```


### By region

```{r policy-42 }
region_plot(scored, income_change)
```


### Black/African American

```{r policy-43 }
bygroup_plot(scored, income_change, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_ttest(scored, income_change, black)
```

### LatinX

```{r policy-44 }
bygroup_plot(scored, income_change, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_ttest(scored, income_change, latinx)
```

### Low income

```{r policy-45 }
bygroup_plot(scored, income_change, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_ttest(scored, income_change, poverty)
```

### Income by Employment

```{r policy-46}
bygroup_plot(scored, income_change, employ_inc1)
```

```{r}
bygroup_ttest(scored, income_change, employ_inc1)
```

### Related to well-being

```{r policy-47 }
bycont_plot(scored, income_change, wellbeing)
```

```{r policy-48, results = 'asis'}
bcont_table(scored, income_change, wellbeing)
```

## Family Financial Status{.tabset}

```{r policy-49 }
pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  filter(!is.na(financial_status)) %>%
  group_by(financial_status) %>%
  summarize(N = n()) %>%
  as.data.frame()
```


**Which  of the following best describes your family financially at this time?**

Options:

  - No problems $(N = `r pb.table[pb.table$financial_status == "None","N"]`)$
  - Minor problems $(N = `r pb.table[pb.table$financial_status == "Minor","N"]`)$
  - Major problems $(N = `r pb.table[pb.table$financial_status == "Major","N"]`)$
  - Extreme problems $(N = `r pb.table[pb.table$financial_status == "Extreme","N"]`)$
  
_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-50 }
overall_figure(scored, financial_status)
```


### Over time

```{r policy-51 }
long_plot(scored, financial_status)
```


### By region

```{r policy-52 }
region_plot(scored, financial_status)
```


### Black/African American

```{r policy-53 }
bygroup_plot(scored, financial_status, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_ttest(scored, financial_status, black)
```

### LatinX

```{r policy-54 }
bygroup_plot(scored, financial_status, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_ttest(scored, financial_status, latinx)
```

### Low income

```{r policy-55 }
bygroup_plot(scored, financial_status, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_ttest(scored, financial_status, poverty150)
```

### Income by Employment

```{r policy-56}
bygroup_plot(scored, financial_status, employ_inc1)
```

```{r}
bygroup_ttest(scored, financial_status, employ_inc1)
```

### Related to well-being

```{r policy-57 }
bycont_plot(scored, financial_status, wellbeing)
```

```{r policy-58, results = 'asis'}
bcont_table(scored, financial_status, wellbeing)
```

# Physical Health

## Well-baby/Well-child Checkup{.tabset}

```{r policy-59 }
scored = scored %>%
  mutate(missed_wellbaby = factor(missed_wellbaby, levels = c(0, 1), labels = c("No", "Yes")))

pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  filter(!is.na(missed_wellbaby)) %>%
  group_by(missed_wellbaby) %>%
  summarize(N = n()) %>%
  as.data.frame()
```


**Have you missed a well-baby/well-child checkup since the coronavirus (COVID-19) pandemic began?**

Options:

  - No $(N = `r pb.table[pb.table$missed_wellbaby == "No","N"]`)$
  - Yes $(N = `r pb.table[pb.table$missed_wellbaby == "Yes","N"]`)$
  
_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-60 }
overall_figure(scored, missed_wellbaby)
```


### Over time

```{r policy-61 }
long_plot(scored, missed_wellbaby)
```


### By region

```{r policy-62 }
region_plot(scored, missed_wellbaby)
```


### Black/African American

```{r policy-63 }
bygroup_plot(scored, missed_wellbaby, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_ttest(scored, missed_wellbaby, black)
```

### LatinX

```{r policy-64 }
bygroup_plot(scored, missed_wellbaby, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_ttest(scored, missed_wellbaby, latinx)
```

### Low income

```{r policy-65 }
bygroup_plot(scored, missed_wellbaby, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_ttest(scored, missed_wellbaby, poverty150)
```

### Income by Employment

```{r policy-66}
bygroup_plot(scored, missed_wellbaby, employ_inc1)
```

```{r}
bygroup_ttest(scored, missed_wellbaby, employ_inc1)
```

### Related to well-being

```{r policy-67 }
bycont_plot(scored, missed_wellbaby, wellbeing)
```

```{r policy-68, results = 'asis'}
bcont_table(scored, missed_wellbaby, wellbeing)
```

## Missed vaccine{.tabset}

```{r policy-69 }
scored = scored %>%
  mutate(missed_vaccine = case_when(
    miss_vaccine.1 == 1 ~ "Yes",
    miss_vaccine.2 == 1 ~ "Yes",
    miss_vaccine.3 == 1 ~ "Yes",
    miss_vaccine.4 == 1 ~ "Yes",
    miss_vaccine.5 == 1 ~ "Yes",
    !is.na(miss_vaccine.1) ~ "No",
    !is.na(miss_vaccine.2) ~ "No",
    !is.na(miss_vaccine.3) ~ "No",
    !is.na(miss_vaccine.4) ~ "No",
    !is.na(miss_vaccine.5) ~ "No",
    missed_wellbaby == 0 ~ "No",
    TRUE ~ NA_character_
  ))

pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  filter(!is.na(missed_vaccine)) %>%
  group_by(missed_vaccine) %>%
  summarize(N = n()) %>%
  as.data.frame()
```


**[If yes missed well-baby] [asked for up to five children] Did they miss a scheduled vaccine at this visit?**

Options:

  - No $(N = `r pb.table[pb.table$missed_vaccine == "No","N"]`)$
  - Yes $(N = `r pb.table[pb.table$missed_vaccine == "Yes","N"]`)$
  
_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-70 }
overall_figure(scored, missed_vaccine)
```


### Over time

```{r policy-71 }
long_plot(scored, missed_vaccine)
```


### By region

```{r policy-72 }
region_plot(scored, missed_vaccine)
```


### Black/African American

```{r policy-73 }
bygroup_plot(scored, missed_vaccine, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_ttest(scored, missed_vaccine, black)
```

### LatinX

```{r policy-74 }
bygroup_plot(scored, missed_vaccine, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_ttest(scored, missed_vaccine, latinx)
```

### Low income

```{r policy-75 }
bygroup_plot(scored, missed_vaccine, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_ttest(scored, missed_vaccine, poverty150)
```

### Income by Employment

```{r policy-76}
bygroup_plot(scored, missed_vaccine, employ_inc1)
```

```{r}
bygroup_ttest(scored, missed_vaccine, employ_inc1)
```

### Related to well-being

```{r policy-77 }
bycont_plot(scored, missed_vaccine, wellbeing)
```

```{r policy-78, results = 'asis'}
bcont_table(scored, missed_vaccine, wellbeing)
```

## Barriers to well-child{.tabset}

```{r policy-79 }
pb_cat.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  ungroup() %>%
  summarize_at(vars(contains("missed_wb")), .funs = list(sum), na.rm=T)
```


**â—	What prevented you from going to a well-baby checkup? [Select all that apply.]**

Options:

  - Cost $(N = `r pb_cat.table$missed_wb_cost`)$ 
  - Unable to get time away from work $(N = `r pb_cat.table$missed_wb_time.away.from.work`)$ 
  - Inability to find childcare $(N = `r pb_cat.table$missed_wb_inability.find.childcare`)$ 
  - Concern over exposure to coronavirus (COVID-19) $(N = `r pb_cat.table$missed_wb_concern.for.covid`)$ 
  - Caring for family members $(N = `r pb_cat.table$missed_wb_caring.for.family`)$ 
  - Vaccine hesitancy $(N = `r pb_cat.table$missed_wb_vaccine.hesitancy`)$ 
  - Other, please describe $(N = `r pb_cat.table$missed_wb_other`)$ 



_Sample sizes are based on caregiver response at the most recent week of participation._

```{r policy-80 }
pb_vars = find_items("missed_wb", scored)
pb_labels = pb_vars %>%
  gsub("missed_wb_", "", .) %>%
  gsub("\\.", " ", .) %>%
  stringr::str_to_sentence()
```

### Overall

```{r policy-81 }
overall_c_figure(scored, pb_vars, pb_labels)
```

### Over time

```{r policy-82 }
long_c_plot(scored, pb_vars, pb_labels)
```


### By region

```{r policy-83 }
region_c_plot(scored, pb_vars, pb_labels)
```


### Black/African American

```{r policy-84 }
bygroup_c_plot(scored, pb_vars, pb_labels, black, g.levels = c(0,1), g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_c_ttest(scored, pb_vars, pb_labels, black)
```

### LatinX

```{r policy-85 }
bygroup_c_plot(scored, pb_vars, pb_labels, latinx, g.levels = c(0,1), g.labels = c("Everyone else", "LatinX"))
```


```{r}
bygroup_c_ttest(scored, pb_vars, pb_labels, latinx)
```

### Low income

```{r policy-86 }
bygroup_c_plot(scored, pb_vars, pb_labels, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```


```{r}
bygroup_c_ttest(scored, pb_vars, pb_labels, poverty150)
```
### Income by Employment

```{r policy-87}
bygroup_c_plot(scored, pb_vars, pb_labels, employ_inc1)
```


```{r}
bygroup_c_ttest(scored, pb_vars, pb_labels, employ_inc1)
```

### Related to well-being

```{r policy-88 }
bycont_c_plot(scored, pb_vars, pb_labels, wellbeing)
```

```{r policy-89, results = 'asis'}
#bcont_table(scored, public_benefits, wellbeing)
```

# Basic Needs

## Free food (currently){.tabset}

```{r policy-90 }
pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  filter(!is.na(free_food_cat)) %>%
  group_by(free_food_cat) %>%
  summarize(N = n()) %>%
  as.data.frame()
```


**Do  you currently have access to free food for your household? Examples of free food include food pantries and programs, SNAP etc.**

Options:

  - Yes $(N = `r pb.table[pb.table$free_food_cat == "Yes","N"]`)$
  - No, but I know where/how I can access free food resources $(N = `r pb.table[pb.table$free_food_cat == "No, know how","N"]`)$
  - No, I am not eligible for free food resources $(N = `r pb.table[pb.table$free_food_cat == "No, not eligible","N"]`)$
  - Unsure $(N = `r pb.table[pb.table$free_food_cat == "Unsure","N"]`)$
  
_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-91 }
overall_figure(scored, free_food_cat)
```


### Over time

```{r policy-92 }
long_plot(scored, free_food_cat)
```


### By region

```{r policy-93 }
region_plot(scored, free_food_cat)
```


### Black/African American

```{r policy-94 }
bygroup_plot(scored, free_food_cat, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```
```{r}
bygroup_ttest(scored, free_food_cat, black)
```

### LatinX

```{r policy-95 }
bygroup_plot(scored, free_food_cat, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_ttest(scored, free_food_cat, latinx)
```

### Low income

```{r policy-96 }
bygroup_plot(scored, free_food_cat, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_ttest(scored, free_food_cat, poverty150)
```

### Income by Employment

```{r policy-97}
bygroup_plot(scored, free_food_cat, employ_inc1)
```

```{r}
bygroup_ttest(scored, free_food_cat, employ_inc1)
```

### Related to well-being

```{r policy-98 }
bycont_plot(scored, free_food_cat, wellbeing)
```

```{r policy-99, results = 'asis'}
bcont_table(scored, free_food_cat, wellbeing)
```

<!-- ## Free Lunch (pre-COVID){.tabset} -->

<!-- ```{r policy-91 } -->
<!-- pb.table = scored %>% -->
<!--   group_by(CaregiverID) %>% -->
<!--   filter(Week == max(Week)) %>% -->
<!--   filter(!is.na(free_lunch_pre_cat)) %>% -->
<!--   group_by(free_lunch_pre_cat) %>% -->
<!--   summarize(N = n()) %>% -->
<!--   as.data.frame() -->
<!-- ``` -->


<!-- **Do  you currently have access to free food for your household? Examples of free food include food pantries and programs, SNAP etc.** -->

<!-- Options: -->

<!-- - Yes, my child(ren) received free or reduced lunches $(N = `r pb.table[pb.table$free_lunch_pre_cat == "Yes","N"]`)$ -->
<!-- - No, free or reduced lunches were not available for my children $(N = `r pb.table[pb.table$free_lunch_pre_cat == "No, not available","N"]`)$ -->
<!-- - No, my child did not receive free or reduced lunches, but they were available $(N = `r pb.table[pb.table$free_lunch_pre_cat == "No, but available","N"]`)$ -->
<!-- - No, free or reduced lunches were not available for my children $(N = `r pb.table[pb.table$free_lunch_pre_cat == "Yes","N"]`)$ -->
<!-- - No, but I had planned on getting free or reduced lunches for my children soon $(N = `r pb.table[pb.table$free_lunch_pre_cat == "No, planned","N"]`)$ -->
<!-- - No, I didn't know how to access this resource $(N = `r pb.table[pb.table$free_lunch_pre_cat == "No, didn't know how","N"]`)$ -->
<!-- - Not applicable $(N = `r pb.table[pb.table$free_lunch_pre_cat == "N/A","N"]`)$ -->


<!-- _Sample sizes are based on caregiver response at the most recent week of participation._ -->

<!-- ### Overall -->

<!-- ```{r policy-92 } -->
<!-- overall_figure(scored, free_lunch_pre_cat) -->
<!-- ``` -->


<!-- ### Over time -->

<!-- ```{r policy-93 } -->
<!-- long_plot(scored, free_lunch_pre_cat) -->
<!-- ``` -->


<!-- ### By region -->

<!-- ```{r policy-94 } -->
<!-- region_plot(scored, free_lunch_pre_cat) -->
<!-- ``` -->


<!-- ### Black/African American -->

<!-- ```{r policy-95 } -->
<!-- bygroup_plot(scored, free_lunch_pre_cat, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black")) -->
<!-- ``` -->

<!-- ### LatinX -->

<!-- ```{r policy-96 } -->
<!-- bygroup_plot(scored, free_lunch_pre_cat, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX")) -->
<!-- ``` -->

<!-- ### Low income -->

<!-- ```{r policy-97 } -->
<!-- bygroup_plot(scored, free_lunch_pre_cat, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income")) -->
<!-- ``` -->

<!-- ### Related to well-being -->

<!-- ```{r policy-98 } -->
<!-- bycont_plot(scored, free_lunch_pre_cat, wellbeing) -->
<!-- ``` -->

<!-- ```{r policy-99, results = 'asis'} -->
<!-- bcont_table(scored, free_lunch_pre_cat, wellbeing) -->
<!-- ``` -->

## Free Lunch (during-COVID){.tabset}

```{r policy-100 }
pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  filter(!is.na(free_lunch_now_cat)) %>%
  group_by(free_lunch_now_cat) %>%
  summarize(N = n()) %>%
  as.data.frame()
```


**Prior to coronavirus (COVID-19), did you get free or reduced lunches for your child(ren)?**

Options:

- Yes, my child(ren) received free or reduced lunches $(N = `r pb.table[pb.table$free_lunch_now_cat == "Yes","N"]`)$
- No, free or reduced lunches were not available for my children $(N = `r pb.table[pb.table$free_lunch_now_cat == "No, not available","N"]`)$
- No, my child did not receive free or reduced lunches, but they were available $(N = `r pb.table[pb.table$free_lunch_now_cat == "No, but available","N"]`)$
- No, free or reduced lunches were not available for my children $(N = `r pb.table[pb.table$free_lunch_now_cat == "Yes","N"]`)$
- No, but I had planned on getting free or reduced lunches for my children soon $(N = `r pb.table[pb.table$free_lunch_now_cat == "No, planned","N"]`)$
- No, I didn't know how to access this resource $(N = `r pb.table[pb.table$free_lunch_now_cat == "No, didn't know how","N"]`)$
- Not applicable $(N = `r pb.table[pb.table$free_lunch_now_cat == "N/A","N"]`)$

  
_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-101 }
overall_figure(scored, free_lunch_now_cat)
```


### Over time

```{r policy-102 }
long_plot(scored, free_lunch_now_cat)
```


### By region

```{r policy-103 }
region_plot(scored, free_lunch_now_cat)
```


### Black/African American

```{r policy-104 }
bygroup_plot(scored, free_lunch_now_cat, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```


```{r}
bygroup_ttest(scored, free_lunch_now_cat, black)
```
### LatinX

```{r policy-105 }
bygroup_plot(scored, free_lunch_now_cat, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_ttest(scored, free_lunch_now_cat, latinx)
```

### Low income

```{r policy-106 }
bygroup_plot(scored, free_lunch_now_cat, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_ttest(scored, free_lunch_now_cat, poverty150)
```

```{r}
bygroup_ttest(scored, free_lunch_now_cat, poverty150)
```

### Income by Employment

```{r policy-107}
bygroup_plot(scored, free_lunch_now_cat, employ_inc1)
```

```{r}
bygroup_ttest(scored, free_lunch_now_cat, employ_inc1)
```

### Related to well-being

```{r policy-108 }
bycont_plot(scored, free_lunch_now_cat, wellbeing)
```

```{r policy-109, results = 'asis'}
bcont_table(scored, free_lunch_now_cat, wellbeing)
```

## Paying for basics{.tabset}

```{r policy-110 }
pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  filter(!is.na(difficulty_basics_cat)) %>%
  group_by(difficulty_basics_cat) %>%
  summarize(N = n()) %>%
  as.data.frame()
```


**In the past month, how hard has it been for you to pay for the very basics like food, housing, medical care, and heating?**

Options:

- Very hard $(N = `r pb.table[pb.table$difficulty_basics_cat == "Very hard","N"]`)$
- Hard $(N = `r pb.table[pb.table$difficulty_basics_cat == "Hard","N"]`)$
- Somewhat hard $(N = `r pb.table[pb.table$difficulty_basics_cat == "Somewaht hard","N"]`)$
- Not very hard $(N = `r pb.table[pb.table$difficulty_basics_cat == "Not very hard","N"]`)$
  
_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-111 }
overall_figure(scored, difficulty_basics_cat)
```


### Over time

```{r policy-112 }
long_plot(scored, difficulty_basics_cat)
```


### By region

```{r policy-113 }
region_plot(scored, difficulty_basics_cat)
```


### Black/African American

```{r policy-114 }
bygroup_plot(scored, difficulty_basics_cat, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_ttest(scored, difficulty_basics_cat, black)
```
### LatinX

```{r policy-115 }
bygroup_plot(scored, difficulty_basics_cat, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_ttest(scored, difficulty_basics_cat, latinx)
```

### Low income

```{r policy-116 }
bygroup_plot(scored, difficulty_basics_cat, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_ttest(scored, difficulty_basics_cat, poverty150)
```

### Income by Employment

```{r policy-117}
bygroup_plot(scored, difficulty_basics_cat, employ_inc1)
```

```{r}
bygroup_ttest(scored, difficulty_basics_cat, employ_inc1)
```

### Related to well-being

```{r policy-118 }
bycont_plot(scored, difficulty_basics_cat, wellbeing)
```

```{r policy-119, results = 'asis'}
bcont_table(scored, difficulty_basics_cat, wellbeing)
```

## Which needs{.tabset}

```{r policy-120 }
pb_cat.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  ungroup() %>%
  summarize_at(vars(contains("diff_pay_")), .funs = list(sum), na.rm=T)
```


**Which of these needs have been hard to pay for in the past month? [Select all that apply.]**

Options:

  - Food $(N = `r pb_cat.table$diff_pay_food`)$ 
  - Housing $(N = `r pb_cat.table$diff_pay_house`)$ 
  - Utilities (electric, water, trash) $(N = `r pb_cat.table$diff_pay_ultilities`)$ 
  - Healthcare $(N = `r pb_cat.table$diff_pay_healthcare`)$ 
  - Social $(N = `r pb_cat.table$diff_pay_social`)$ 
  - Emotional $(N = `r pb_cat.table$diff_pay_emotional`)$ 
  - Childcare $(N = `r pb_cat.table$diff_pay_childcare`)$ 
  - Other $(N = `r pb_cat.table$diff_pay_other`)$ 



_Sample sizes are based on caregiver response at the most recent week of participation._

```{r policy-121 }
pb_vars = find_items("diff_pay_", scored)
pb_labels = pb_vars %>%
  gsub("diff_pay_", "", .) %>%
  stringr::str_to_sentence()
```

### Overall

```{r policy-122 }
overall_c_figure(scored, pb_vars, pb_labels)
```

### Over time

```{r policy-123 }
long_c_plot(scored, pb_vars, pb_labels)
```


### By region

```{r policy-124 }
region_c_plot(scored, pb_vars, pb_labels)
```


### Black/African American

```{r policy-125 }
bygroup_c_plot(scored, pb_vars, pb_labels, black, g.levels = c(0,1), g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_c_ttest(scored, pb_vars, pb_labels, black)
```
### LatinX

```{r policy-126 }
bygroup_c_plot(scored, pb_vars, pb_labels, latinx, g.levels = c(0,1), g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_c_ttest(scored, pb_vars, pb_labels, latinx)
```

### Low income

```{r policy-127 }
bygroup_c_plot(scored, pb_vars, pb_labels, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_c_ttest(scored, pb_vars, pb_labels, poverty150)
```

### Income by Employment

```{r policy-128}
bygroup_c_plot(scored, pb_vars, pb_labels, employ_inc1)
```

```{r}
bygroup_c_ttest(scored, pb_vars, pb_labels, employ_inc1)
```

### Related to well-being

```{r policy-129 }
bycont_c_plot(scored, pb_vars, pb_labels, wellbeing)
```

```{r policy-130, results = 'asis'}
#bcont_table(scored, public_benefits, wellbeing)
```

## Material hardship{.tabset}

```{r policy-131 }
scored = scored %>%
  rowwise() %>%
  mutate(material_hardship = sum(c_across(starts_with("diff_pay")), na.rm=T))

pb.table = scored %>%
  group_by(CaregiverID) %>%
  filter(Week == max(Week)) %>%
  filter(!is.na(material_hardship)) %>%
  group_by(material_hardship) %>%
  summarize(N = n()) %>%
  as.data.frame()
```

**This variables was calculated by adding up the number of needs selected for the following question: Which of these needs have been hard to pay for in the past month? [Select all that apply.]**

  - 0 $(N = `r pb.table[pb.table$material_hardship == 0,"N"]`)$
  - 1 $(N = `r pb.table[pb.table$material_hardship == 1,"N"]`)$
  - 2 $(N = `r pb.table[pb.table$material_hardship == 2,"N"]`)$
  - 3 $(N = `r pb.table[pb.table$material_hardship == 3,"N"]`)$
  - 4 $(N = `r pb.table[pb.table$material_hardship == 4,"N"]`)$
  - 5 $(N = `r pb.table[pb.table$material_hardship == 5,"N"]`)$
  - 6 $(N = `r pb.table[pb.table$material_hardship == 6,"N"]`)$
  - 7 $(N = `r pb.table[pb.table$material_hardship == 7,"N"]`)$
  - 8 $(N = `r pb.table[pb.table$material_hardship == 8,"N"]`)$
  
For these analyses, we censor responses at 1 (creating a 1+ category).

```{r policy-132 }
scored = scored %>%
  mutate(material_hardship = case_when(
    material_hardship >= 1 ~ "1+",
    !is.na(material_hardship) ~ as.character(material_hardship),
    TRUE ~ NA_character_
  ))
```



_Sample sizes are based on caregiver response at the most recent week of participation._

### Overall

```{r policy-133 }
overall_figure(scored, material_hardship)
```


### Over time

```{r policy-134 }
long_plot(scored, material_hardship)
```


### By region

```{r policy-135 }
region_plot(scored, material_hardship)
```


### Black/African American

```{r policy-136 }
bygroup_plot(scored, material_hardship, black, g.levels = c(0,1),g.labels = c("Everyone else", "Black"))
```

```{r}
bygroup_ttest(scored, material_hardship, black)
```

### LatinX

```{r policy-137 }
bygroup_plot(scored, material_hardship, latinx, g.levels = c(0,1),g.labels = c("Everyone else", "LatinX"))
```

```{r}
bygroup_ttest(scored, material_hardship, latinx)
```

### Low income

```{r policy-138 }
bygroup_plot(scored, material_hardship, poverty150, g.levels = c(0,1),g.labels = c("High Income", "Low Income"))
```

```{r}
bygroup_ttest(scored, material_hardship, poverty150)
```

### Income by Employment

```{r policy-139}
bygroup_plot(scored, material_hardship, employ_inc1)
```

```{r}
bygroup_ttest(scored, material_hardship, employ_inc1)
```

### Related to well-being

```{r policy-140 }
bycont_plot(scored, material_hardship, wellbeing)
```

```{r policy-141, results = 'asis'}
bcont_table(scored, material_hardship, wellbeing)
```
