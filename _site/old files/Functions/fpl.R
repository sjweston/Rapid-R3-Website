FPL.function = function(JOB.002, STATE_CODED, allyearly){
  
  fpl.group = case_when(
    JOB.002 == 1 & STATE_CODED == 1 & allyearly <= 12760 ~ 1,
    JOB.002 == 1 & STATE_CODED == 1 & allyearly >= 12761 & allyearly <=  15950 ~ 2,
    JOB.002 == 1 & STATE_CODED == 1 & allyearly >= 15951 & allyearly <=  19140 ~ 3,
    JOB.002 == 1 & STATE_CODED == 1 & allyearly >= 19141 & allyearly <=  25520 ~ 4,
    JOB.002 == 1 & STATE_CODED == 1 & allyearly > 25520 ~ 5,
    JOB.002 == 2 & STATE_CODED == 1 &  allyearly <= 17240 ~ 1,
    JOB.002 == 2 & STATE_CODED == 1 & allyearly >= 17241 & allyearly <=  21550 ~ 2,
    JOB.002 == 2 & STATE_CODED == 1 & allyearly >= 21551 & allyearly <=  25860 ~ 3,
    JOB.002 == 2 & STATE_CODED == 1 & allyearly >= 25861 & allyearly <=  34480 ~ 4,
    JOB.002 == 2 & STATE_CODED == 1 & allyearly > 34480 ~ 5,
    JOB.002 == 3 & STATE_CODED == 1 & allyearly <= 21720 ~ 1,
    JOB.002 == 3 & STATE_CODED == 1 & allyearly >= 21721 & allyearly <=  27150 ~ 2,
    JOB.002 == 3 & STATE_CODED == 1 & allyearly >= 27151 & allyearly <=  32580 ~ 3,
    JOB.002 == 3 & STATE_CODED == 1 & allyearly >= 32581 & allyearly <=  43440 ~ 4,
    JOB.002 == 3 & STATE_CODED == 1 & allyearly > 43440 ~ 5,
    JOB.002 == 4 & STATE_CODED == 1 & allyearly <= 26200 ~ 1,
    JOB.002 == 4 & STATE_CODED == 1 & allyearly >= 26201 & allyearly <=  32750 ~ 2,
    JOB.002 == 4 & STATE_CODED == 1 & allyearly >= 32751 & allyearly <=  39300 ~ 3,
    JOB.002 == 4 & STATE_CODED == 1 & allyearly >= 39301 & allyearly <=  52400 ~ 4,
    JOB.002 == 4 & STATE_CODED == 1 & allyearly > 52400 ~ 5,
    JOB.002 == 5 & STATE_CODED == 1 & allyearly <= 30680 ~ 1,
    JOB.002 == 5 & STATE_CODED == 1 & allyearly >= 30681 & allyearly <=  38350 ~ 2,
    JOB.002 == 5 & STATE_CODED == 1 & allyearly >= 38351 & allyearly <=  46020 ~ 3,
    JOB.002 == 5 & STATE_CODED == 1 & allyearly >= 46021 & allyearly <=  61360 ~ 4,
    JOB.002 == 5 & STATE_CODED == 1 & allyearly > 61360 ~ 5,
    JOB.002 == 6 & STATE_CODED == 1 & allyearly <= 35160 ~ 1,
    JOB.002 == 6 & STATE_CODED == 1 & allyearly >= 35161 & allyearly <=  43950 ~ 2,
    JOB.002 == 6 & STATE_CODED == 1 & allyearly >= 43951 & allyearly <=  52740 ~ 3,
    JOB.002 == 6 & STATE_CODED == 1 & allyearly >= 52741 & allyearly <=  70320 ~ 4,
    JOB.002 == 6 & STATE_CODED == 1 & allyearly > 70320 ~ 5,
    JOB.002 == 7 & STATE_CODED == 1 & allyearly <= 39640 ~ 1,
    JOB.002 == 7 & STATE_CODED == 1 & allyearly >= 39641 & allyearly <=  49550 ~ 2,
    JOB.002 == 7 & STATE_CODED == 1 & allyearly >= 49551 & allyearly <=  59460 ~ 3,
    JOB.002 == 7 & STATE_CODED == 1 & allyearly >= 59461 & allyearly <=  79280 ~ 4,
    JOB.002 == 7 & STATE_CODED == 1 & allyearly > 79280 ~ 5,
    JOB.002 == 8 & STATE_CODED == 1 & allyearly <= 44120 ~ 1,
    JOB.002 == 8 & STATE_CODED == 1 & allyearly >= 44121 & allyearly <=  55150 ~ 2,
    JOB.002 == 8 & STATE_CODED == 1 & allyearly >= 55151 & allyearly <=  66180 ~ 3,
    JOB.002 == 8 & STATE_CODED == 1 & allyearly >= 66180 & allyearly <=  88240 ~ 4,
    JOB.002 == 8 & STATE_CODED == 1 & allyearly > 88240 ~ 5,
    JOB.002 == 9 & STATE_CODED == 1 & allyearly <= 48600 ~ 1,
    JOB.002 == 9 & STATE_CODED == 1 & allyearly >= 48601 & allyearly <=  60750 ~ 2,
    JOB.002 == 9 & STATE_CODED == 1 & allyearly >= 60751 & allyearly <=  72900 ~ 3,
    JOB.002 == 9 & STATE_CODED == 1 & allyearly >= 72901 & allyearly <=  97200 ~ 4,
    JOB.002 == 9 & STATE_CODED == 1 & allyearly > 97200 ~ 5,
    JOB.002 == 10 & STATE_CODED == 1 & allyearly <= 53080 ~ 1,
    JOB.002 == 10 & STATE_CODED == 1 & allyearly >= 53081 & allyearly <=  66350 ~ 2,
    JOB.002 == 10 & STATE_CODED == 1 & allyearly >= 66351 & allyearly <=  79620 ~ 3,
    JOB.002 == 10 & STATE_CODED == 1 & allyearly >= 79621 & allyearly <=  106160 ~ 4,
    JOB.002 == 10 & STATE_CODED == 1 & allyearly > 106160 ~ 5,
    JOB.002 == 11 & STATE_CODED == 1 & allyearly <= 57560 ~ 1,
    JOB.002 == 11 & STATE_CODED == 1 & allyearly >= 57561 & allyearly <=  70830 ~ 2,
    JOB.002 == 11 & STATE_CODED == 1 & allyearly >= 70831 & allyearly <=  84100 ~ 3,
    JOB.002 == 11 & STATE_CODED == 1 & allyearly >= 84101 & allyearly <=  110640 ~ 4,
    JOB.002 == 11 & STATE_CODED == 1 & allyearly > 110640 ~ 5,
    JOB.002 == 12 & STATE_CODED == 1 & allyearly <= 62040 ~ 1,
    JOB.002 == 12 & STATE_CODED == 1 & allyearly >= 62041 & allyearly <=  75310 ~ 2,
    JOB.002 == 12 & STATE_CODED == 1 & allyearly >= 75311 & allyearly <=  88580 ~ 3,
    JOB.002 == 12 & STATE_CODED == 1 & allyearly >= 88581 & allyearly <=  115120 ~ 4,
    JOB.002 == 12 & STATE_CODED == 1 & allyearly > 115120 ~ 5,
    JOB.002 == 13 & STATE_CODED == 1 & allyearly <= 66520 ~ 1,
    JOB.002 == 13 & STATE_CODED == 1 & allyearly >= 66521 & allyearly <=  79790 ~ 2,
    JOB.002 == 13 & STATE_CODED == 1 & allyearly >= 79791 & allyearly <=  93060 ~ 3,
    JOB.002 == 13 & STATE_CODED == 1 & allyearly >= 93061 & allyearly <=  119600 ~ 4,
    JOB.002 == 13 & STATE_CODED == 1 & allyearly > 119600 ~ 5,
    JOB.002 == 14 & STATE_CODED == 1 & allyearly <= 71000 ~ 1,
    JOB.002 == 14 & STATE_CODED == 1 & allyearly >= 71001 & allyearly <=  84270 ~ 2,
    JOB.002 == 14 & STATE_CODED == 1 & allyearly >= 84271 & allyearly <=  97540 ~ 3,
    JOB.002 == 14 & STATE_CODED == 1 & allyearly >= 97541 & allyearly <=  124080 ~ 4,
    JOB.002 == 14 & STATE_CODED == 1 & allyearly > 124080 ~ 5,
    JOB.002 == 15 & STATE_CODED == 1 & allyearly <= 75480 ~ 1,
    JOB.002 == 15 & STATE_CODED == 1 & allyearly >= 75481 & allyearly <=  88750 ~ 2,
    JOB.002 == 15 & STATE_CODED == 1 & allyearly >= 88751 & allyearly <=  102020 ~ 3,
    JOB.002 == 15 & STATE_CODED == 1 & allyearly >= 102021 & allyearly <=  128560 ~ 4,
    JOB.002 == 15 & STATE_CODED == 1 & allyearly > 128560 ~ 5,
    JOB.002 == 16 & STATE_CODED == 1 & allyearly <= 79960 ~ 1,
    JOB.002 == 16 & STATE_CODED == 1 & allyearly >= 79961 & allyearly <=  93230 ~ 2,
    JOB.002 == 16 & STATE_CODED == 1 & allyearly >= 93231 & allyearly <=  106500 ~ 3,
    JOB.002 == 16 & STATE_CODED == 1 & allyearly >= 106501 & allyearly <=  133040 ~ 4,
    JOB.002 == 16 & STATE_CODED == 1 & allyearly > 133040 ~ 5,
    JOB.002 == 17 & STATE_CODED == 1 & allyearly <= 84440 ~ 1,
    JOB.002 == 17 & STATE_CODED == 1 & allyearly >= 84441 & allyearly <=  97710 ~ 2,
    JOB.002 == 17 & STATE_CODED == 1 & allyearly >= 97711 & allyearly <=  110980 ~ 3,
    JOB.002 == 17 & STATE_CODED == 1 & allyearly >= 110981 & allyearly <=  137520 ~ 4,
    JOB.002 == 17 & STATE_CODED == 1 & allyearly > 137520 ~ 5,
    JOB.002 == 18 & STATE_CODED == 1 & allyearly <= 88920 ~ 1,
    JOB.002 == 18 & STATE_CODED == 1 & allyearly >= 88921 & allyearly <=  102190 ~ 2,
    JOB.002 == 18 & STATE_CODED == 1 & allyearly >= 102190 & allyearly <=  115460 ~ 3,
    JOB.002 == 18 & STATE_CODED == 1 & allyearly >= 115461 & allyearly <=  142000 ~ 4,
    JOB.002 == 18 & STATE_CODED == 1 & allyearly > 142000 ~ 5,
    JOB.002 == 19 & STATE_CODED == 1 & allyearly <= 93400 ~ 1,
    JOB.002 == 19 & STATE_CODED == 1 & allyearly >= 93401 & allyearly <=  106670 ~ 2,
    JOB.002 == 19 & STATE_CODED == 1 & allyearly >= 106671 & allyearly <=  119940 ~ 3,
    JOB.002 == 19 & STATE_CODED == 1 & allyearly >= 119941 & allyearly <=  146480 ~ 4,
    JOB.002 == 19 & STATE_CODED == 1 & allyearly > 146480 ~ 5,
    JOB.002 == 20 & STATE_CODED == 1 & allyearly <= 97880 ~ 1,
    JOB.002 == 20 & STATE_CODED == 1 & allyearly >= 97881 & allyearly <=  111150 ~ 2,
    JOB.002 == 20 & STATE_CODED == 1 & allyearly >= 111151 & allyearly <=  124420 ~ 3,
    JOB.002 == 20 & STATE_CODED == 1 & allyearly >= 124421 & allyearly <=  150960 ~ 4,
    JOB.002 == 20 & STATE_CODED == 1 & allyearly > 150960 ~ 5,
    JOB.002 == 21 & STATE_CODED == 1 & allyearly <= 102360 ~ 1,
    JOB.002 == 21 & STATE_CODED == 1 & allyearly >= 102361 & allyearly <=  115630 ~ 2,
    JOB.002 == 21 & STATE_CODED == 1 & allyearly >= 115631 & allyearly <=  128900 ~ 3,
    JOB.002 == 21 & STATE_CODED == 1 & allyearly >= 128901 & allyearly <=  155440 ~ 4,
    JOB.002 == 21 & STATE_CODED == 1 & allyearly > 155440 ~ 5,
    JOB.002 == 1 & STATE_CODED == 2 & allyearly <= 15950 ~ 1,
    JOB.002 == 1 & STATE_CODED == 2 & allyearly >= 15951 & allyearly <=  19938 ~ 2,
    JOB.002 == 1 & STATE_CODED == 2 & allyearly >= 19939 & allyearly <=  23925 ~ 3,
    JOB.002 == 1 & STATE_CODED == 2 & allyearly >= 23926 & allyearly <=  31900 ~ 4,
    JOB.002 == 1 & STATE_CODED == 2 & allyearly > 31900 ~ 5,
    JOB.002 == 2 & STATE_CODED == 2 & allyearly <= 21550 ~ 1,
    JOB.002 == 2 & STATE_CODED == 2 & allyearly >= 21551 & allyearly <=  26938 ~ 2,
    JOB.002 == 2 & STATE_CODED == 2 & allyearly >= 26939 & allyearly <=  32325 ~ 3,
    JOB.002 == 2 & STATE_CODED == 2 & allyearly >= 32326 & allyearly <=  43100 ~ 4,
    JOB.002 == 2 & STATE_CODED == 2 & allyearly > 43100 ~ 5,
    JOB.002 == 3 & STATE_CODED == 2 & allyearly <= 27150 ~ 1,
    JOB.002 == 3 & STATE_CODED == 2 & allyearly >= 27151 & allyearly <=  33938 ~ 2,
    JOB.002 == 3 & STATE_CODED == 2 & allyearly >= 33939 & allyearly <=  40725 ~ 3,
    JOB.002 == 3 & STATE_CODED == 2 & allyearly >= 40726 & allyearly <=  54300 ~ 4,
    JOB.002 == 3 & STATE_CODED == 2 & allyearly > 54300 ~ 5,
    JOB.002 == 4 & STATE_CODED == 2 & allyearly <= 32750 ~ 1,
    JOB.002 == 4 & STATE_CODED == 2 & allyearly >= 32751 & allyearly <=  40938 ~ 2,
    JOB.002 == 4 & STATE_CODED == 2 & allyearly >= 40939 & allyearly <=  49125 ~ 3,
    JOB.002 == 4 & STATE_CODED == 2 & allyearly >= 49126 & allyearly <=  62500 ~ 4,
    JOB.002 == 4 & STATE_CODED == 2 & allyearly > 62500 ~ 5,
    JOB.002 == 5 & STATE_CODED == 2 & allyearly <= 38350 ~ 1,
    JOB.002 == 5 & STATE_CODED == 2 & allyearly >= 38351 & allyearly <=  47938 ~ 2,
    JOB.002 == 5 & STATE_CODED == 2 & allyearly >= 47939 & allyearly <=  57525 ~ 3,
    JOB.002 == 5 & STATE_CODED == 2 & allyearly >= 57526 & allyearly <=  76700 ~ 4,
    JOB.002 == 5 & STATE_CODED == 2 & allyearly > 76700 ~ 5,
    JOB.002 == 6 & STATE_CODED == 2 & allyearly <= 43950 ~ 1,
    JOB.002 == 6 & STATE_CODED == 2 & allyearly >= 43951 & allyearly <=  54938 ~ 2,
    JOB.002 == 6 & STATE_CODED == 2 & allyearly >= 54939 & allyearly <=  65925 ~ 3,
    JOB.002 == 6 & STATE_CODED == 2 & allyearly >= 65296 & allyearly <=  87900 ~ 4,
    JOB.002 == 6 & STATE_CODED == 2 & allyearly > 87900 ~ 5,
    JOB.002 == 7 & STATE_CODED == 2 & allyearly <= 49550 ~ 1,
    JOB.002 == 7 & STATE_CODED == 2 & allyearly >= 49551 & allyearly <=  61938 ~ 2,
    JOB.002 == 7 & STATE_CODED == 2 & allyearly >= 61939 & allyearly <=  74325 ~ 3,
    JOB.002 == 7 & STATE_CODED == 2 & allyearly >= 74326 & allyearly <=  99100 ~ 4,
    JOB.002 == 7 & STATE_CODED == 2 & allyearly > 99100 ~ 5,
    JOB.002 == 8 & STATE_CODED == 2 & allyearly <= 55150 ~ 1,
    JOB.002 == 8 & STATE_CODED == 2 & allyearly >= 55151 & allyearly <=  68938 ~ 2,
    JOB.002 == 8 & STATE_CODED == 2 & allyearly >= 68939 & allyearly <=  82725 ~ 3,
    JOB.002 == 8 & STATE_CODED == 2 & allyearly >= 82726 & allyearly <=  110300 ~ 4,
    JOB.002 == 8 & STATE_CODED == 2 & allyearly > 110300 ~ 5,
    JOB.002 == 9 & STATE_CODED == 2 & allyearly <= 60750 ~ 1,
    JOB.002 == 9 & STATE_CODED == 2 & allyearly >= 60751 & allyearly <=  75938 ~ 2,
    JOB.002 == 9 & STATE_CODED == 2 & allyearly >= 75939 & allyearly <=  91125 ~ 3,
    JOB.002 == 9 & STATE_CODED == 2 & allyearly >= 91126 & allyearly <=  121500 ~ 4,
    JOB.002 == 9 & STATE_CODED == 2 & allyearly > 121500 ~ 5,
    JOB.002 == 10 & STATE_CODED == 2 & allyearly <= 66350 ~ 1,
    JOB.002 == 10 & STATE_CODED == 2 & allyearly >= 66351 & allyearly <=  82938 ~ 2,
    JOB.002 == 10 & STATE_CODED == 2 & allyearly >= 82939 & allyearly <=  99525 ~ 3,
    JOB.002 == 10 & STATE_CODED == 2 & allyearly >= 99526 & allyearly <=  132700 ~ 4,
    JOB.002 == 10 & STATE_CODED == 2 & allyearly > 132700 ~ 5,
    JOB.002 == 11 & STATE_CODED == 2 & allyearly <= 71950 ~ 1,
    JOB.002 == 11 & STATE_CODED == 2 & allyearly >= 71951 & allyearly <=  89938 ~ 2,
    JOB.002 == 11 & STATE_CODED == 2 & allyearly >= 89939 & allyearly <=  107925 ~ 3,
    JOB.002 == 11 & STATE_CODED == 2 & allyearly >= 107926 & allyearly <=  143900 ~ 4,
    JOB.002 == 11 & STATE_CODED == 2 & allyearly > 143900 ~ 5,
    JOB.002 == 12 & STATE_CODED == 2 & allyearly <= 77550 ~ 1,
    JOB.002 == 12 & STATE_CODED == 2 & allyearly >= 77551 & allyearly <=  96938 ~ 2,
    JOB.002 == 12 & STATE_CODED == 2 & allyearly >= 96939 & allyearly <=  116325 ~ 3,
    JOB.002 == 12 & STATE_CODED == 2 & allyearly >= 116326 & allyearly <=  155100 ~ 4,
    JOB.002 == 12 & STATE_CODED == 2 & allyearly > 155100 ~ 5,
    JOB.002 == 13 & STATE_CODED == 2 & allyearly <= 79980 ~ 1,
    JOB.002 == 13 & STATE_CODED == 2 & allyearly >= 79981 & allyearly <=  99975 ~ 2,
    JOB.002 == 13 & STATE_CODED == 2 & allyearly >= 99976 & allyearly <=  119970 ~ 3,
    JOB.002 == 13 & STATE_CODED == 2 & allyearly >= 11971 & allyearly <=  159960 ~ 4,
    JOB.002 == 13 & STATE_CODED == 2 & allyearly > 159960 ~ 5,
    JOB.002 == 14 & STATE_CODED == 2 & allyearly <= 85380 ~ 1,
    JOB.002 == 14 & STATE_CODED == 2 & allyearly >= 85381 & allyearly <=  106725 ~ 2,
    JOB.002 == 14 & STATE_CODED == 2 & allyearly >= 106726 & allyearly <=  128070 ~ 3,
    JOB.002 == 14 & STATE_CODED == 2 & allyearly >= 128071 & allyearly <=  170760 ~ 4,
    JOB.002 == 14 & STATE_CODED == 2 & allyearly > 170760 ~ 5,
    JOB.002 == 15 & STATE_CODED == 2 & allyearly <= 90980 ~ 1,
    JOB.002 == 15 & STATE_CODED == 2 & allyearly >= 90981 & allyearly <=  112325 ~ 2,
    JOB.002 == 15 & STATE_CODED == 2 & allyearly >= 112326 & allyearly <=  133670 ~ 3,
    JOB.002 == 15 & STATE_CODED == 2 & allyearly >= 133671 & allyearly <=  176360 ~ 4,
    JOB.002 == 15 & STATE_CODED == 2 & allyearly > 176360 ~ 5,
    JOB.002 == 16 & STATE_CODED == 2 & allyearly <= 96580 ~ 1,
    JOB.002 == 16 & STATE_CODED == 2 & allyearly >= 96581 & allyearly <=  117925 ~ 2,
    JOB.002 == 16 & STATE_CODED == 2 & allyearly >= 117926 & allyearly <=  139270 ~ 3,
    JOB.002 == 16 & STATE_CODED == 2 & allyearly >= 139271 & allyearly <=  181960 ~ 4,
    JOB.002 == 16 & STATE_CODED == 2 & allyearly > 181960 ~ 5,
    JOB.002 == 17 & STATE_CODED == 2 & allyearly <= 102180 ~ 1,
    JOB.002 == 17 & STATE_CODED == 2 & allyearly >= 102181 & allyearly <=  123525 ~ 2,
    JOB.002 == 17 & STATE_CODED == 2 & allyearly >= 123526 & allyearly <=  144870 ~ 3,
    JOB.002 == 17 & STATE_CODED == 2 & allyearly >= 144871 & allyearly <=  187560 ~ 4,
    JOB.002 == 17 & STATE_CODED == 2 & allyearly > 187560 ~ 5,
    JOB.002 == 18 & STATE_CODED == 2 & allyearly <= 107780 ~ 1,
    JOB.002 == 18 & STATE_CODED == 2 & allyearly >= 107781 & allyearly <=  129125 ~ 2,
    JOB.002 == 18 & STATE_CODED == 2 & allyearly >= 129126 & allyearly <=  150470 ~ 3,
    JOB.002 == 18 & STATE_CODED == 2 & allyearly >= 150471 & allyearly <=  193160 ~ 4,
    JOB.002 == 18 & STATE_CODED == 2 & allyearly > 193160 ~ 5,
    JOB.002 == 19 & STATE_CODED == 2 & allyearly <= 113380 ~ 1,
    JOB.002 == 19 & STATE_CODED == 2 & allyearly >= 113381 & allyearly <=  134725 ~ 2,
    JOB.002 == 19 & STATE_CODED == 2 & allyearly >= 124726 & allyearly <=  156070 ~ 3,
    JOB.002 == 19 & STATE_CODED == 2 & allyearly >= 156071 & allyearly <=  198760 ~ 4,
    JOB.002 == 19 & STATE_CODED == 2 & allyearly > 198760 ~ 5,
    JOB.002 == 20 & STATE_CODED == 2 & allyearly <= 118980 ~ 1,
    JOB.002 == 20 & STATE_CODED == 2 & allyearly >= 118981 & allyearly <=  140325 ~ 2,
    JOB.002 == 20 & STATE_CODED == 2 & allyearly >= 140326 & allyearly <=  161670 ~ 3,
    JOB.002 == 20 & STATE_CODED == 2 & allyearly >= 161671 & allyearly <=  204360 ~ 4,
    JOB.002 == 20 & STATE_CODED == 2 & allyearly > 204360 ~ 5,
    JOB.002 == 21 & STATE_CODED == 2 & allyearly <= 124580 ~ 1,
    JOB.002 == 21 & STATE_CODED == 2 & allyearly >= 124581 & allyearly <=  145925 ~ 2,
    JOB.002 == 21 & STATE_CODED == 2 & allyearly >= 145926 & allyearly <=  167270 ~ 3,
    JOB.002 == 21 & STATE_CODED == 2 & allyearly >= 167271 & allyearly <=  209960 ~ 4,
    JOB.002 == 21 & STATE_CODED == 2 & allyearly > 209960 ~ 5,
    JOB.002 == 1 & STATE_CODED == 3 & allyearly <= 14680 ~ 1,
    JOB.002 == 1 & STATE_CODED == 3 & allyearly >= 14681 & allyearly <=  18350 ~ 2,
    JOB.002 == 1 & STATE_CODED == 3 & allyearly >= 18351 & allyearly <=  22020 ~ 3,
    JOB.002 == 1 & STATE_CODED == 3 & allyearly >= 22021 & allyearly <=  29360 ~ 4,
    JOB.002 == 1 & STATE_CODED == 3 & allyearly > 29360 ~ 5,
    JOB.002 == 2 & STATE_CODED == 3 & allyearly <= 19830 ~ 1,
    JOB.002 == 2 & STATE_CODED == 3 & allyearly >= 19831 & allyearly <=  24788 ~ 2,
    JOB.002 == 2 & STATE_CODED == 3 & allyearly >= 24789 & allyearly <=  29745 ~ 3,
    JOB.002 == 2 & STATE_CODED == 3 & allyearly >= 29746 & allyearly <=  39660 ~ 4,
    JOB.002 == 2 & STATE_CODED == 3 & allyearly > 39660 ~ 5,
    JOB.002 == 3 & STATE_CODED == 3 & allyearly <= 24980 ~ 1,
    JOB.002 == 3 & STATE_CODED == 3 & allyearly >= 24981 & allyearly <=  31225 ~ 2,
    JOB.002 == 3 & STATE_CODED == 3 & allyearly >= 31226 & allyearly <=  37470 ~ 3,
    JOB.002 == 3 & STATE_CODED == 3 & allyearly >= 37471 & allyearly <=  49960 ~ 4,
    JOB.002 == 3 & STATE_CODED == 3 & allyearly > 49960 ~ 5,
    JOB.002 == 4 & STATE_CODED == 3 & allyearly <= 30130 ~ 1,
    JOB.002 == 4 & STATE_CODED == 3 & allyearly >= 30131 & allyearly <=  37663 ~ 2,
    JOB.002 == 4 & STATE_CODED == 3 & allyearly >= 37664 & allyearly <=  45195 ~ 3,
    JOB.002 == 4 & STATE_CODED == 3 & allyearly >= 45196 & allyearly <=  60260 ~ 4,
    JOB.002 == 4 & STATE_CODED == 3 & allyearly > 60260 ~ 5,
    JOB.002 == 5 & STATE_CODED == 3 & allyearly <= 35280 ~ 1,
    JOB.002 == 5 & STATE_CODED == 3 & allyearly >= 35281 & allyearly <=  44100 ~ 2,
    JOB.002 == 5 & STATE_CODED == 3 & allyearly >= 44101 & allyearly <=  52920 ~ 3,
    JOB.002 == 5 & STATE_CODED == 3 & allyearly >= 52921 & allyearly <=  70560 ~ 4,
    JOB.002 == 5 & STATE_CODED == 3 & allyearly > 70560 ~ 5,
    JOB.002 == 6 & STATE_CODED == 3 & allyearly <= 40430 ~ 1,
    JOB.002 == 6 & STATE_CODED == 3 & allyearly >= 40431 & allyearly <=  50538 ~ 2,
    JOB.002 == 6 & STATE_CODED == 3 & allyearly >= 50539 & allyearly <=  60645 ~ 3,
    JOB.002 == 6 & STATE_CODED == 3 & allyearly >= 60646 & allyearly <=  80860 ~ 4,
    JOB.002 == 6 & STATE_CODED == 3 & allyearly > 80860 ~ 5,
    JOB.002 == 7 & STATE_CODED == 3 & allyearly <= 45580 ~ 1,
    JOB.002 == 7 & STATE_CODED == 3 & allyearly >= 45581 & allyearly <=  56975 ~ 2,
    JOB.002 == 7 & STATE_CODED == 3 & allyearly >= 56976 & allyearly <=  68370 ~ 3,
    JOB.002 == 7 & STATE_CODED == 3 & allyearly >= 68371 & allyearly <=  91160 ~ 4,
    JOB.002 == 7 & STATE_CODED == 3 & allyearly > 91160 ~ 5,
    JOB.002 == 8 & STATE_CODED == 3 & allyearly <= 50730 ~ 1,
    JOB.002 == 8 & STATE_CODED == 3 & allyearly >= 50731 & allyearly <=  63413 ~ 2,
    JOB.002 == 8 & STATE_CODED == 3 & allyearly >= 63414 & allyearly <=  76095 ~ 3,
    JOB.002 == 8 & STATE_CODED == 3 & allyearly >= 76096 & allyearly <=  101460 ~ 4,
    JOB.002 == 8 & STATE_CODED == 3 & allyearly > 101460 ~ 5,
    JOB.002 == 9 & STATE_CODED == 3 & allyearly <= 55880 ~ 1,
    JOB.002 == 9 & STATE_CODED == 3 & allyearly >= 55881 & allyearly <=  69850 ~ 2,
    JOB.002 == 9 & STATE_CODED == 3 & allyearly >= 69851 & allyearly <=  83820 ~ 3,
    JOB.002 == 9 & STATE_CODED == 3 & allyearly >= 83821 & allyearly <=  111760 ~ 4,
    JOB.002 == 9 & STATE_CODED == 3 & allyearly > 111760 ~ 5,
    JOB.002 == 10 & STATE_CODED == 3 & allyearly <= 61030 ~ 1,
    JOB.002 == 10 & STATE_CODED == 3 & allyearly >= 61031 & allyearly <=  76288 ~ 2,
    JOB.002 == 10 & STATE_CODED == 3 & allyearly >= 76289 & allyearly <=  91545 ~ 3,
    JOB.002 == 10 & STATE_CODED == 3 & allyearly >= 91546 & allyearly <=  122060 ~ 4,
    JOB.002 == 10 & STATE_CODED == 3 & allyearly > 122060 ~ 5,
    JOB.002 == 11 & STATE_CODED == 3 & allyearly <= 66180 ~ 1,
    JOB.002 == 11 & STATE_CODED == 3 & allyearly >= 66181 & allyearly <=  82725 ~ 2,
    JOB.002 == 11 & STATE_CODED == 3 & allyearly >= 82726 & allyearly <=  99270 ~ 3,
    JOB.002 == 11 & STATE_CODED == 3 & allyearly >= 99271 & allyearly <=  132360 ~ 4,
    JOB.002 == 11 & STATE_CODED == 3 & allyearly > 132360 ~ 5,
    JOB.002 == 12 & STATE_CODED == 3 & allyearly <= 71330 ~ 1,
    JOB.002 == 12 & STATE_CODED == 3 & allyearly >= 71331 & allyearly <=  89163 ~ 2,
    JOB.002 == 12 & STATE_CODED == 3 & allyearly >= 89164 & allyearly <=  106995 ~ 3,
    JOB.002 == 12 & STATE_CODED == 3 & allyearly >= 106996 & allyearly <=  142660 ~ 4,
    JOB.002 == 12 & STATE_CODED == 3 & allyearly > 142660 ~ 5,
    JOB.002 == 13 & STATE_CODED == 3 & allyearly <= 73600 ~ 1,
    JOB.002 == 13 & STATE_CODED == 3 & allyearly >= 73601 & allyearly <=  92000 ~ 2,
    JOB.002 == 13 & STATE_CODED == 3 & allyearly >= 92001 & allyearly <=  110400 ~ 3,
    JOB.002 == 13 & STATE_CODED == 3 & allyearly >= 110401 & allyearly <=  147200 ~ 4,
    JOB.002 == 13 & STATE_CODED == 3 & allyearly > 147200 ~ 5,
    JOB.002 == 14 & STATE_CODED == 3 & allyearly <= 78570 ~ 1,
    JOB.002 == 14 & STATE_CODED == 3 & allyearly >= 78571 & allyearly <=  98213 ~ 2,
    JOB.002 == 14 & STATE_CODED == 3 & allyearly >= 98214 & allyearly <=  117855 ~ 3,
    JOB.002 == 14 & STATE_CODED == 3 & allyearly >= 117856 & allyearly <=  157140 ~ 4,
    JOB.002 == 14 & STATE_CODED == 3 & allyearly > 157140 ~ 5,
    JOB.002 == 15 & STATE_CODED == 3 & allyearly <= 83720 ~ 1,
    JOB.002 == 15 & STATE_CODED == 3 & allyearly >= 83721 & allyearly <=  103363 ~ 2,
    JOB.002 == 15 & STATE_CODED == 3 & allyearly >= 103364 & allyearly <=  123005 ~ 3,
    JOB.002 == 15 & STATE_CODED == 3 & allyearly >= 123006 & allyearly <=  162290 ~ 4,
    JOB.002 == 15 & STATE_CODED == 3 & allyearly > 162290 ~ 5,
    JOB.002 == 16 & STATE_CODED == 3 & allyearly <= 88870 ~ 1,
    JOB.002 == 16 & STATE_CODED == 3 & allyearly >= 88871 & allyearly <=  108513 ~ 2,
    JOB.002 == 16 & STATE_CODED == 3 & allyearly >= 108514 & allyearly <=  128155 ~ 3,
    JOB.002 == 16 & STATE_CODED == 3 & allyearly >= 128156 & allyearly <=  167440 ~ 4,
    JOB.002 == 16 & STATE_CODED == 3 & allyearly > 167440 ~ 5,
    JOB.002 == 17 & STATE_CODED == 3 & allyearly <= 94020 ~ 1,
    JOB.002 == 17 & STATE_CODED == 3 & allyearly >= 94021 & allyearly <=  113663 ~ 2,
    JOB.002 == 17 & STATE_CODED == 3 & allyearly >= 113664 & allyearly <=  133305 ~ 3,
    JOB.002 == 17 & STATE_CODED == 3 & allyearly >= 133306 & allyearly <=  172590 ~ 4,
    JOB.002 == 17 & STATE_CODED == 3 & allyearly > 172590 ~ 5,
    JOB.002 == 18 & STATE_CODED == 3 & allyearly <= 99170 ~ 1,
    JOB.002 == 18 & STATE_CODED == 3 & allyearly >= 99171 & allyearly <=  118813 ~ 2,
    JOB.002 == 18 & STATE_CODED == 3 & allyearly >= 118814 & allyearly <=  138455 ~ 3,
    JOB.002 == 18 & STATE_CODED == 3 & allyearly >= 138456 & allyearly <=  177740 ~ 4,
    JOB.002 == 18 & STATE_CODED == 3 & allyearly > 177740 ~ 5,
    JOB.002 == 19 & STATE_CODED == 3 & allyearly <= 104320 ~ 1,
    JOB.002 == 19 & STATE_CODED == 3 & allyearly >= 104321 & allyearly <=  123963 ~ 2,
    JOB.002 == 19 & STATE_CODED == 3 & allyearly >= 123964 & allyearly <=  143605 ~ 3,
    JOB.002 == 19 & STATE_CODED == 3 & allyearly >= 143606 & allyearly <=  182890 ~ 4,
    JOB.002 == 19 & STATE_CODED == 3 & allyearly > 182890 ~ 5,
    JOB.002 == 20 & STATE_CODED == 3 & allyearly <= 109470 ~ 1,
    JOB.002 == 20 & STATE_CODED == 3 & allyearly >= 109471 & allyearly <=  129113 ~ 2,
    JOB.002 == 20 & STATE_CODED == 3 & allyearly >= 129114 & allyearly <=  148755 ~ 3,
    JOB.002 == 20 & STATE_CODED == 3 & allyearly >= 148756 & allyearly <=  188040 ~ 4,
    JOB.002 == 20 & STATE_CODED == 3 & allyearly > 188040 ~ 5,
    JOB.002 == 21 & STATE_CODED == 3 & allyearly <= 114620 ~ 1,
    JOB.002 == 21 & STATE_CODED == 3 & allyearly >= 114621 & allyearly <=  134263 ~ 2,
    JOB.002 == 21 & STATE_CODED == 3 & allyearly >= 134264 & allyearly <=  153905 ~ 3,
    JOB.002 == 21 & STATE_CODED == 3 & allyearly >= 153906 & allyearly <=  193190 ~ 4,
    JOB.002 == 21 & STATE_CODED == 3 & allyearly > 193190 ~ 5,
    TRUE ~ NA_real_)
  return(fpl.group)
}

factor.fpl = function(fpl){
  factor(fpl, labels = c("At or Below 100% of FPL",
                         "101 to 125% of FPL",
                         "126 to 150% of FPL",
                         "'151 to 200% of FPL",
                         "Above 200% of FPL"))
}