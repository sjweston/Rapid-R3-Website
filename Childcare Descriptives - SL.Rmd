---
title: "Childcare Variables Descriptives"
author: "Sihong"
date: "10/2/2020"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, include = FALSE}
library(here)
library(tidyverse)
library(knitr)
library(kableExtra)
library(readr)
library(haven)
```

```{r, include=FALSE}
# load scored master data --------------------------------------------------------
load(here::here("../../Data Management R3/R data/scored.Rdata"))
```

```{r, echo=FALSE, message = FALSE}
total_weeks = max(scored$Week, na.rm=T)
key_demo <- c ("race_cat", "race_ethnic", "poverty_cat", "unemployment", "unemployed", "work_status", "disability", "single", "single_cat")

ccare <- scored %>%
  select (CaregiverID, Week, BaselineWeek, key_demo, contains ("familyCC"), contains ("cc_"), contains ("hours_"), contains ("cc2_"), contains ("priorcc_"), contains ("expect_"), contains ("same_cc"), comfort_return, contains ("know_cc"), lack_cc)

num_responses = function(x){length(which(!is.na(x)))}
ccare.num = ccare %>%
  group_by(Week) %>%
  summarize_all(num_responses) %>%
  gather("Variable", "num_responses",-Week) %>%
  mutate(week = paste0("Week", Week),
         week = factor(Week, levels = paste0("Week", c(1:total_weeks)))) %>%
  spread(Week, num_responses)



#Merge even-number weeks with preceding odd-number weeks, starting from week 18. Because there are no overlapping respondents across the two weeks, we only need to change the name of weeks. 
ccare$Week[which(ccare$Week == 18)] <- 17
ccare$Week[which(ccare$Week == 20)] <- 19
ccare$Week[which(ccare$Week == 22)] <- 21
ccare$Week[which(ccare$Week == 24)] <- 23

ccare <- ccare%>%
  mutate (singleparent = (ifelse (single == 1, "single parent", "not single parent")),
          cdisability = (ifelse (disability == 1, "child with disability", "child without disability")))

```


# Methods Families Chose for Childcare
## Percentage of Non-Parental Childcare
  *Data based on weeks 5-6, and 9-25
  
### Total Responses Breakdown by Race/Ethnicity and Income
```{r, echo=FALSE, message = FALSE}
#recode nonparental variable to include week 1-3 and 7-8
##results of recoding look weird, possibly because the way we ask questions are different. So I did not use this method in final analyses. Syntax saved just in case we need to revisit it later. 
#ccare <- ccare %>%
#  mutate (c_nonparental = ifelse ((((Week>=1& Week<=3))&(cc_sibling==1|cc_grandparent==1|cc_othRelative==1|cc_familydaycare==1|cc_childCareCenter==1|cc_HeadStart==1|cc_nursery==1|cc_BefAfSchool==1|cc_childSelfCare==1)|((Week>8|Week==4|Week==5|Week==6|Week==0)&cc2_nonparental==1)), 1,0))

cc_np_pre <- ccare %>%
  filter (Week == 0) %>%
  count (cc2_nonparental, poverty_cat, race_ethnic) %>%
  filter (poverty_cat != "NA" & race_ethnic != "NA" & cc2_nonparental != "NA" ) %>%
 group_by (poverty_cat, race_ethnic)%>%
 mutate(prop = prop.table(n))

cc_np_pre %>%
  filter (cc2_nonparental == 1)%>%
  ggplot ( mapping = aes (y = race_ethnic, x = prop*100))+
  geom_col() + 
  geom_text(aes(label = round(prop*100,2)),vjust = 1.6, color = "white")+
  ggtitle ("Percentage of Families Using Non-Parental Childcare - Pre-COVID19")+
  xlim (0,100) +
  coord_flip()+
  facet_wrap (~poverty_cat)

cc_np_post <- ccare %>%
  filter (Week != 0) %>%
  count (cc2_nonparental, poverty_cat, race_ethnic) %>%
  filter (poverty_cat != "NA" & race_ethnic != "NA" & cc2_nonparental != "NA" ) %>%
 group_by (poverty_cat, race_ethnic)%>%
 mutate(prop = prop.table(n))

cc_np_post %>%
  filter (cc2_nonparental == 1)%>%
  ggplot ( mapping = aes (y = race_ethnic, x = prop*100))+
  geom_col() + 
  geom_text(aes(label = round(prop*100,2)),vjust = 1.6, color = "white")+
  ggtitle ("Percentage of Families Using Non-Parental Childcare - Post-COVID19")+
  xlim (0,100) +
  coord_flip()+
  facet_wrap (~poverty_cat)
```

### Total Responses Breakdown by Single Parent Status
```{r, echo=FALSE, message = FALSE}
cc_np_pre <- ccare %>%
  filter (Week == 0) %>%
  count (cc2_nonparental, singleparent) %>%
  filter (singleparent != "NA" & cc2_nonparental != "NA" ) %>%
 group_by (singleparent)%>%
 mutate(prop = prop.table(n))

cc_np_pre %>%
  filter (cc2_nonparental == 1)%>%
  ggplot ( mapping = aes (x = singleparent, y = prop*100)) + 
  geom_col() + 
  geom_text(aes(label = round(prop*100,2)),vjust = 1.6, color = "white")+
  ggtitle ("Pre-COVID19")+
  ylim (0,100)

cc_np_post <- ccare %>%
  filter (Week != 0) %>%
  count (cc2_nonparental, singleparent) %>%
   filter (singleparent != "NA" & cc2_nonparental != "NA" ) %>%
 group_by (singleparent)%>%
 mutate(prop = prop.table(n))

cc_np_post %>%
  filter (cc2_nonparental == 1)%>%
  ggplot ( mapping = aes (x = singleparent, y = prop*100))+
  geom_col() + 
  geom_text(aes(label = round(prop*100,2)),vjust = 1.6, color = "white")+
  ggtitle ("Post-COVID19")+
  ylim (0,100)
  
```

### Total Responses Breakdown by Child Disability Status
```{r, echo=FALSE, message = FALSE}
cc_np_pre <- ccare %>%
  filter (Week == 0) %>%
  count (cc2_nonparental, cdisability) %>%
  filter (cdisability != "NA" & cc2_nonparental != "NA" ) %>%
 group_by (cdisability)%>%
 mutate(prop = prop.table(n))

cc_np_pre %>%
  filter (cc2_nonparental == 1)%>%
  ggplot ( mapping = aes (x = cdisability, y = prop*100)) + 
  geom_col() +
  geom_text(aes(label = round(prop*100,2)),vjust = 1.6, color = "white")+
  ggtitle ("Pre-COVID19")+
  ylim (0,100)

cc_np_post <- ccare %>%
  filter (Week != 0) %>%
  count (cc2_nonparental, cdisability) %>%
   filter (cdisability != "NA" & cc2_nonparental != "NA" ) %>%
 group_by (cdisability)%>%
 mutate(prop = prop.table(n))

cc_np_post %>%
  filter (cc2_nonparental == 1)%>%
  ggplot ( mapping = aes (x = cdisability, y = prop*100))+
  geom_col() +
  geom_text(aes(label = round(prop*100,2)),vjust = 1.6, color = "white")+
  ggtitle ("Post-COVID19")+
  ylim (0,100)
  
```

### Changes of Percentage of Non-Parental Childcare Over Time
```{r, echo=FALSE, message = FALSE}
cc_week <- ccare %>%
  filter (Week!=1&Week!=2&Week!=3&Week!=7&Week!=8)%>%
  group_by (Week) %>%
  summarize (total = n(), 
             ccnp_pct = sum (cc2_nonparental, na.rm = TRUE)/total*100) 

ggplot (data = cc_week, aes (x = Week, y = ccnp_pct)) +
  geom_point (size = 2) +
  geom_line()+
   scale_x_continuous(breaks = c(0:total_weeks))+
    scale_y_continuous(limits = c(0,100)) 
```

  *Note. 
  1. Data of weeks 17 & 18, 19 & 20, 21 & 22, and 23 & 24 were merged to increase sample size and reduce the fluctuation 
  2. Data on this question were not collected on weeks 1, 2, 3, 7, 8. 

### Changes of Percentage of Non-Parental Childcare Over Time - Breakdown by Income
```{r, echo=FALSE, message = FALSE}
cc_week_im <- ccare %>%
  group_by (Week, poverty_cat) %>%
  summarize (total = n(), 
             ccnp_pct = sum (cc2_nonparental, na.rm = TRUE)/total*100) %>%
  filter (Week != 1 & Week != 2 & Week != 3 & Week != 7 & Week != 8 & poverty_cat != "NA")

ggplot (data = cc_week_im, aes (x = Week, y = ccnp_pct, color = poverty_cat)) +
  geom_point (size = 2) +
  geom_line()+
   scale_x_continuous(breaks = c(0:total_weeks))+
    scale_y_continuous(limits = c(0,100)) 
```

### Changes of Percentage of Non-Parental Childcare Over Time - Breakdown by Race/Ethnicity
```{r, echo=FALSE, message = FALSE}
cc_week_rc <- ccare %>%
  group_by (Week, race_ethnic) %>%
  summarize (total = n(), 
             ccnp_pct = sum (cc2_nonparental, na.rm = TRUE)/total*100) %>%
  filter (Week != 1 & Week != 2 & Week != 3 & Week != 7 & Week != 8 & race_ethnic != "NA")

ggplot (data = cc_week_rc, aes (x = Week, y = ccnp_pct, color = race_ethnic)) +
  geom_point (size = 2) +
  geom_line()+
   scale_x_continuous(breaks = c(0:total_weeks))+
    scale_y_continuous(limits = c(0,100)) 
```

### Changes of Percentage of Non-Parental Childcare Over Time - Breakdown by Income and Race/Ethnicity
```{r, echo=FALSE, message = FALSE}
cc_week_rcim <- ccare %>%
  group_by (Week, race_ethnic, poverty_cat) %>%
  summarize (total = n(), 
             ccnp_pct = sum (cc2_nonparental, na.rm = TRUE)/total*100) %>%
  filter (Week != 1 & Week != 2 & Week != 3 & Week != 7 & Week != 8 & Week != 20 & race_ethnic != "NA" & poverty_cat != "NA")

ggplot (data = cc_week_rcim, aes (x = Week, y = ccnp_pct, color = race_ethnic)) +
  geom_point (size = 2) +
  geom_line()+
   scale_x_continuous(breaks = c(0:total_weeks))+
    scale_y_continuous(limits = c(0,100)) +
  facet_wrap (~poverty_cat)
```

### Changes of Percentage of Non-Parental Childcare Over Time - Breakdown by Single Parent Status
```{r, echo=FALSE, message = FALSE}
cc_week_sp <- ccare %>%
  group_by (Week, singleparent) %>%
  summarize (total = n(), 
             ccnp_pct = sum (cc2_nonparental, na.rm = TRUE)/total*100) %>%
  filter (Week != 1 & Week != 2 & Week != 3 & Week != 7 & Week != 8 & Week != 20 & singleparent != "NA" )

ggplot (data = cc_week_sp, aes (x = Week, y = ccnp_pct, color = singleparent)) +
  geom_point (size = 2) +
  geom_line()+
   scale_x_continuous(breaks = c(0:total_weeks))+
    scale_y_continuous(limits = c(0,100)) 
```

### Changes of Percentage of Non-Parental Childcare Over Time - Breakdown by Child Disability Status
```{r, echo=FALSE, message = FALSE}
cc_week_sp <- ccare %>%
  group_by (Week, cdisability) %>%
  summarize (total = n(), 
             ccnp_pct = sum (cc2_nonparental, na.rm = TRUE)/total*100) %>%
  filter (Week != 1 & Week != 2 & Week != 3 & Week != 7 & Week != 8 & Week != 20 & cdisability != "NA" )

ggplot (data = cc_week_sp, aes (x = Week, y = ccnp_pct, color = cdisability)) +
  geom_point (size = 2) +
  geom_line()+
   scale_x_continuous(breaks = c(0:total_weeks))+
    scale_y_continuous(limits = c(0,100)) 
```

## Among Caregivers Using Nonparental Childcare, Options They Chose
  *Data based on weeks 5-6, and 9-25
### Total Responses 
```{r, echo=FALSE, message = FALSE}
cc_np_pre <- ccare %>%
  filter (Week == 0 & cc2_nonparental==1) %>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_pre %>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Pre-COVID19")+
  xlim (0,50) +
  coord_flip()

cc_np_post <- ccare %>%
  filter (Week != 0 & cc2_nonparental==1) %>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_post %>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Post-COVID19")+
  xlim (0,50) +
  coord_flip()

```

  *Note: These figures present the percentage of childcare options caregivers chose to use among those who reported using any non-parental childcare methods.
  c_unpaid = Using unpaid care by a relative, friend, or neighbor (>5+ hours per week)\newline
  c_paid = Using paid care by a relative, friend, or neighbor (>5+ hours per week);
  c_center = Using paid or unpaid center-based care, such as pre-school, day care, etc. but not include kindergarten;
  c_home = Using paid care from a home-based child care provider (>5+ hours per week).

### Responses Breakdown by Race/Ethnicity
```{r, echo=FALSE, message = FALSE}
cc_np_pre <- ccare %>%
  filter (Week == 0 & cc2_nonparental==1) %>%
  group_by(race_ethnic)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_pre %>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Pre-COVID19")+
  xlim (0,50) +
  coord_flip()+
  facet_wrap (~race_ethnic)

cc_np_post <- ccare %>%
  filter (Week != 0 & cc2_nonparental==1) %>%
  group_by(race_ethnic)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_post %>%
  filter (race_ethnic!= "NA")%>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Post-COVID19")+
  xlim (0,50) +
  coord_flip()+
  facet_wrap (~race_ethnic)
```

### Responses Breakdown by Income
```{r, echo=FALSE, message = FALSE}
cc_np_pre <- ccare %>%
  filter (Week == 0 & cc2_nonparental==1) %>%
  group_by(poverty_cat)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_pre %>%
  filter (poverty_cat!= "NA")%>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Pre-COVID19")+
  xlim (0,60) +
  coord_flip()+
  facet_wrap (~poverty_cat)

cc_np_post <- ccare %>%
  filter (Week != 0 & cc2_nonparental==1) %>%
  group_by(poverty_cat)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_post %>%
  filter (poverty_cat!= "NA")%>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Post-COVID19")+
  xlim (0,60) +
  coord_flip()+
  facet_wrap (~poverty_cat)

```


### Responses Breakdown by Income and Race/Ethnicity
```{r, echo=FALSE, message = FALSE}
cc_np_pre <- ccare %>%
  filter (Week == 0 & cc2_nonparental==1) %>%
  group_by(poverty_cat, race_ethnic)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_pre %>%
  filter (poverty_cat!= "NA" & race_ethnic != "NA")%>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Pre-COVID19")+
  xlim (0,60) +
  coord_flip()+
  facet_wrap (poverty_cat~race_ethnic)

cc_np_post <- ccare %>%
  filter (Week != 0 & cc2_nonparental==1) %>%
  group_by(poverty_cat,race_ethnic)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_post %>%
  filter (poverty_cat!= "NA" & race_ethnic != "NA")%>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Post-COVID19")+
  xlim (0,60) +
  coord_flip()+
  facet_wrap (poverty_cat~race_ethnic)

```

### Responses Breakdown by Single Parent Status
```{r, echo=FALSE, message = FALSE}
cc_np_pre <- ccare %>%
  filter (Week == 0 & cc2_nonparental==1) %>%
  group_by(singleparent)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_pre %>%
  filter (singleparent!= "NA")%>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Pre-COVID19")+
  xlim (0,60) +
  coord_flip()+
  facet_wrap (~singleparent)

cc_np_post <- ccare %>%
  filter (Week != 0 & cc2_nonparental==1) %>%
  group_by(singleparent)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_post %>%
  filter (singleparent!= "NA")%>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Post-COVID19")+
  xlim (0,60) +
  coord_flip()+
  facet_wrap (~singleparent)

```


### Responses Breakdown by Child Disability Status
```{r, echo=FALSE, message = FALSE}
cc_np_pre <- ccare %>%
  filter (Week == 0 & cc2_nonparental==1) %>%
  group_by(cdisability)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_pre %>%
  filter (cdisability!= "NA")%>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Pre-COVID19")+
  xlim (0,60) +
  coord_flip()+
  facet_wrap (~cdisability)

cc_np_post <- ccare %>%
  filter (Week != 0 & cc2_nonparental==1) %>%
  group_by(cdisability)%>%
  summarise (n = n(), 
             c_unpaid = round(sum(cc2_unpaid, na.rm = TRUE)/n*100, 2),
             c_paid = round(sum(cc2_paid, na.rm = TRUE)/n*100,2),
             c_center = round(sum(cc2_centerbased, na.rm = TRUE)/n*100,2),
             c_home = round(sum(cc2_homebased, na.rm = TRUE)/n*100,2)) %>%
  pivot_longer(cols = c("c_unpaid","c_paid", "c_center", "c_home"), names_to = "ChildCareMethod", values_to = "Percent" )

cc_np_post %>%
  filter (cdisability!= "NA")%>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col() + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Post-COVID19")+
  xlim (0,60) +
  coord_flip()+
  facet_wrap (~cdisability)

```

## Except for parents, who are taking childcare responsibilites? 
  *Data based on weeks 1-4
  
### Total Responses 
```{r, echo=FALSE, message = FALSE}
#Issues with baseline data coding. If week > 4, baseline for cc_ questions should be missing, not 0. 
ccare$cc_parent[which(ccare$BaselineWeek>4)] <- NA
ccare$cc_sibling[which(ccare$BaselineWeek>4)] <- NA
ccare$cc_grandparent[which(ccare$BaselineWeek>4)] <- NA
ccare$cc_othRelative[which(ccare$BaselineWeek>4)] <- NA
ccare$cc_childSelfCare[which(ccare$BaselineWeek>4)] <- NA
ccare$cc_familydaycare[which(ccare$BaselineWeek>4)] <- NA
ccare$cc_BefAfSchool[which(ccare$BaselineWeek>4)] <- NA
ccare$cc_childCareCenter[which(ccare$BaselineWeek>4)] <- NA
ccare$cc_nursery[which(ccare$BaselineWeek>4)] <- NA
ccare$cc_HeadStart[which(ccare$BaselineWeek>4)] <- NA
```

```{r, echo=FALSE, message = FALSE}
#cc_np_pre <- ccare %>%
#  filter (Week == 0) %>%
#  summarise (n = n(), 
 #           othparent = sum(cc_parent, na.rm = TRUE)/n*100,
  #          sibling = sum(cc_sibling, na.rm = TRUE)/n*100,
   #         grandparent = sum(cc_grandparent, na.rm = TRUE)/n*100,
    #        othRelative = sum(cc_othRelative, na.rm = TRUE)/n*100,
     #       selfcare = sum(cc_childSelfCare, na.rm = TRUE)/n*100,
      #      familydaycare = sum(cc_familydaycare, na.rm = TRUE)/n*100,
       #     BefAfSchool = sum(cc_BefAfSchool, na.rm = TRUE)/n*100,
        #    CCCenter = sum(cc_childCareCenter, na.rm = TRUE)/n*100,
         #   nursery = sum(cc_nursery, na.rm = TRUE)/n*100,
          #  HeadStart = sum(cc_HeadStart, na.rm = TRUE)/n*100) %>%
  #pivot_longer(cols = c("othparent","sibling", "grandparent", "othRelative", "selfcare", "familydaycare", "BefAfSchool", "CCCenter", "nursery", "HeadStart"), names_to = "ChildCareMethod", values_to = "Percent" )

  
#cc_np_pre %>%
#  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
#  geom_col(position = 'dodge') + 
#  geom_text(aes(label = round(Percent,2)),vjust = 1.6, color = "white")+
#  ggtitle ("Pre-COVID19")+
#  xlim (0,50) +
#  coord_flip()

cc_np_post <- ccare %>%
  filter (Week >=1 & Week <=4) %>%
  summarise (n = n(), 
            othparent = round(sum(cc_parent, na.rm = TRUE)/n*100, 2),
            sibling = round(sum(cc_sibling, na.rm = TRUE)/n*100,2),
            grandparent = round(sum(cc_grandparent, na.rm = TRUE)/n*100,2),
            othRelative = round(sum(cc_othRelative, na.rm = TRUE)/n*100,2),
            selfcare = round(sum(cc_childSelfCare, na.rm = TRUE)/n*100,2),
            familydaycare = round(sum(cc_familydaycare, na.rm = TRUE)/n*100,2),
            BefAfSchool = round(sum(cc_BefAfSchool, na.rm = TRUE)/n*100,2),
            CCCenter = round(sum(cc_childCareCenter, na.rm = TRUE)/n*100,2),
            nursery = round(sum(cc_nursery, na.rm = TRUE)/n*100,2),
            HeadStart = round(sum(cc_HeadStart, na.rm = TRUE)/n*100,2)
             ) %>%
  pivot_longer(cols = c("othparent","sibling", "grandparent", "othRelative", "selfcare", "familydaycare", "BefAfSchool", "CCCenter", "nursery", "HeadStart"), names_to = "ChildCareMethod", values_to = "Percent" )

  
cc_np_post %>%
  ggplot ( mapping = aes (x = Percent, y = ChildCareMethod))+
  geom_col(position = 'dodge') + 
  geom_text(aes(label = Percent),vjust = 1.6, color = "white")+
  ggtitle ("Post-COVID19")+
  xlim (0,50) +
  coord_flip()
```

# Hours of Using Family vs. Non-Family Non-Parental Child Care
  *Data based on data from week 1 to 4. 
## Mean of Family & Non-family Childcare Hours - Total Responses

```{r, echo=FALSE, message = FALSE}
#Issues with baseline data coding. If week > 4, baseline for cc_ questions should be missing, not 0. 
ccare$hours_familyCC[which(ccare$BaselineWeek>4)] <- NA
ccare$hours_nonfamilyCC[which(ccare$BaselineWeek>4)] <- NA
```

```{r, echo=FALSE, message = FALSE}
cc_hours <-  ccare %>%
  filter (Week==0 | (Week>=1 & Week <=4))%>%
  summarise (a.familyCC_pre = mean (hours_familyCC, na.rm = TRUE),
             b.nonfamilyCC_pre = mean (hours_nonfamilyCC, na.rm = TRUE),
             c.familyCC_post = mean (hours_familyCC_current, na.rm = TRUE),
             d.nonfamilyCC_post = mean (hours_nonfamilyCC_current, na.rm = TRUE))%>%
  pivot_longer (cols = c("a.familyCC_pre", "b.nonfamilyCC_pre", "c.familyCC_post", "d.nonfamilyCC_post"), names_to = "Cat", values_to = "Mean_hours")

cc_hours %>%
  ggplot (mapping = aes (x = Cat, y = Mean_hours )) +
  geom_bar (stat = "identity")+ 
  geom_text(aes(label = round(Mean_hours,2)),vjust = 1.6, color = "white") 
```

### Pairwise t-tests to Compare Pre-Post COVID-19 Differences
```{r, echo=FALSE, message = FALSE}
cc_hours_t = ccare %>%
  group_by(CaregiverID) %>%
  filter (BaselineWeek <=4 & Week <=4)%>%
  filter(Week == max(Week)|Week == 0) %>%
  select(CaregiverID, contains ("hours_"), key_demo)%>%
  summarise(hours_familyCC = sum (hours_familyCC, na.rm = TRUE), 
            hours_nonfamilyCC = sum (hours_nonfamilyCC, na.rm = TRUE), 
            hours_familyCC_current = sum (hours_familyCC_current, na.rm = TRUE), 
            hours_nonfamilyCC_current = sum (hours_nonfamilyCC_current, na.rm = TRUE))


t.test(cc_hours_t$hours_familyCC, cc_hours_t$hours_familyCC_current, paired = TRUE)
t.test(cc_hours_t$hours_nonfamilyCC, cc_hours_t$hours_nonfamilyCC_current, paired = TRUE)
```

  Paired-sample t-tests show that there are significant increases in using family non-parental childcare and decreases in using non-family non-nonparental childcare from pre- to post-COVID19.

## Mean of Family & Non-family Childcare Hours - Breakdown by Race/Ethnicity
```{r, echo=FALSE, message = FALSE}
cc_hours_rc <-  ccare %>%
  filter (Week==0 | (Week>=1 & Week <=4))%>%
  group_by (race_ethnic)%>%
  summarise (a.familyCC_pre = mean (hours_familyCC, na.rm = TRUE),
             b.nonfamilyCC_pre = mean (hours_nonfamilyCC, na.rm = TRUE),
             c.familyCC_post = mean (hours_familyCC_current, na.rm = TRUE),
             d.nonfamilyCC_post = mean (hours_nonfamilyCC_current, na.rm = TRUE))%>%
  pivot_longer (cols = c("a.familyCC_pre", "b.nonfamilyCC_pre", "c.familyCC_post", "d.nonfamilyCC_post"), names_to = "Cat", values_to = "Mean_hours")

cc_hours_rc %>%
  filter (race_ethnic != "NA")%>%
  ggplot (mapping = aes (x = Cat, y = Mean_hours, fill=race_ethnic )) +
  geom_bar (stat = "identity", position = "dodge")
  
```

## Mean of Family & Non-family Childcare Hours - Breakdown by Income
```{r, echo=FALSE, message = FALSE}
cc_hours_im <-  ccare %>%
   filter (Week==0 | (Week>=1 & Week <=4))%>%
  group_by (poverty_cat)%>%
  summarise (a.familyCC_pre = mean (hours_familyCC, na.rm = TRUE),
             b.nonfamilyCC_pre = mean (hours_nonfamilyCC, na.rm = TRUE),
             c.familyCC_post = mean (hours_familyCC_current, na.rm = TRUE),
             d.nonfamilyCC_post = mean (hours_nonfamilyCC_current, na.rm = TRUE))%>%
  pivot_longer (cols = c("a.familyCC_pre", "b.nonfamilyCC_pre", "c.familyCC_post", "d.nonfamilyCC_post"), names_to = "Cat", values_to = "Mean_hours")

cc_hours_im %>%
  filter (poverty_cat != "NA") %>%
  ggplot (mapping = aes (x = Cat, y = Mean_hours, fill=poverty_cat )) +
  geom_bar (stat = "identity", position = "dodge")
  
```

## Mean of Family & Non-family Childcare Hours - Breakdown by Income & Race/Ethnicity
```{r, echo=FALSE, message = FALSE}
cc_hours_imrc <-  ccare %>%
   filter (Week==0 | (Week>=1 & Week <=4))%>%
  group_by (poverty_cat, race_ethnic)%>%
  summarise (a.f_pre = mean (hours_familyCC, na.rm = TRUE),
             b.n_pre = mean (hours_nonfamilyCC, na.rm = TRUE),
             c.f_post = mean (hours_familyCC_current, na.rm = TRUE),
             d.n_post= mean (hours_nonfamilyCC_current, na.rm = TRUE))%>%
  pivot_longer (cols = c("a.f_pre", "b.n_pre", "c.f_post", "d.n_post"), names_to = "Cat", values_to = "Mean_hours")

cc_hours_imrc %>%
  filter (poverty_cat != "NA" & race_ethnic != "NA") %>%
  ggplot (mapping = aes (x = Cat, y = Mean_hours, fill=poverty_cat )) +
  geom_bar (stat = "identity", position = "dodge") +
  facet_wrap (~race_ethnic)
  
```

  *Note. 
  f_pre = family child care - pre-COVID19;
  n_pre = non-family child care - pre-COVID19;
  f_post = family child care - post-COVID19;
  n_post = family child care - post-COVID19.


## Mean of Family & Non-family Childcare Hours - Breakdown by Single Parental Status
```{r, echo=FALSE, message = FALSE}
cc_hours_sp <-  ccare %>%
   filter (Week==0 | (Week>=1 & Week <=4))%>%
  group_by (singleparent)%>%
  summarise (a.familyCC_pre = mean (hours_familyCC, na.rm = TRUE),
             b.nonfamilyCC_pre = mean (hours_nonfamilyCC, na.rm = TRUE),
             c.familyCC_post = mean (hours_familyCC_current, na.rm = TRUE),
             d.nonfamilyCC_post = mean (hours_nonfamilyCC_current, na.rm = TRUE))%>%
  pivot_longer (cols = c("a.familyCC_pre", "b.nonfamilyCC_pre", "c.familyCC_post", "d.nonfamilyCC_post"), names_to = "Cat", values_to = "Mean_hours")

cc_hours_sp %>%
  filter (singleparent != "NA") %>%
  ggplot (mapping = aes (x = Cat, y = Mean_hours, fill=singleparent )) +
  geom_bar (stat = "identity", position = "dodge")
  
```

## Mean of Family & Non-family Childcare Hours - Breakdown by Child Disability Status
```{r, echo=FALSE, message = FALSE}
cc_hours_cd <-  ccare %>%
  group_by (cdisability)%>%
  summarise (a.familyCC_pre = mean (hours_familyCC, na.rm = TRUE),
             b.nonfamilyCC_pre = mean (hours_nonfamilyCC, na.rm = TRUE),
             c.familyCC_post = mean (hours_familyCC_current, na.rm = TRUE),
             d.nonfamilyCC_post = mean (hours_nonfamilyCC_current, na.rm = TRUE))%>%
  pivot_longer (cols = c("a.familyCC_pre", "b.nonfamilyCC_pre", "c.familyCC_post", "d.nonfamilyCC_post"), names_to = "Cat", values_to = "Mean_hours")

cc_hours_cd %>%
  filter (cdisability != "NA") %>%
  ggplot (mapping = aes (x = Cat, y = Mean_hours, fill=cdisability )) +
  geom_bar (stat = "identity", position = "dodge")
  
```


# Who Parents Are Expecting to Provide Childcare? 
  *Based on Data Collected from Weeks 7 & 8

```{r, echo=FALSE, message = FALSE}

cc_expect <- ccare %>%
  filter (Week == 7| Week == 8) %>%
  summarise (n = n(), 
            center = sum(expect_center, na.rm = TRUE)/n*100,
             rl_myhome = sum(expect_relativemyhome, na.rm = TRUE)/n*100,
             rl_theirhome = sum(expect_relativetheirhome, na.rm = TRUE)/n*100,
             pf_myhome = sum(expect_promyhome, na.rm = TRUE)/n*100,
             pf_theirhome = sum(expect_theirhome, na.rm = TRUE)/n*100,
             parents = sum(expect_parents, na.rm = TRUE)/n*100
             ) %>%
  pivot_longer(cols = c("center","rl_myhome", "rl_theirhome", "pf_myhome", "pf_theirhome", "parents"), names_to = "ExpectMethod", values_to = "Percent" )

  
cc_expect %>%
  ggplot ( mapping = aes (x = Percent, y = ExpectMethod)) +
  geom_col(position = 'dodge') + 
  geom_text(aes(label = round (Percent,2)),vjust = 1.6, color = "white")+
  xlim (0,100) +
  coord_flip()
```
  *Note. center = childcare center; rl_myhome = relatives at the caregivers' home; rl_theirhome = relatives at their home; pf_myhome = professional child provider at the caregivers' home; pf_theirhome = professional childcare provider in their home; parents = the child's parents/legal gardians.
  
  
## The Relationship Between Child and Childcare Provider - Among All Respondents of Week 7 & 8

```{r, echo=FALSE, message = FALSE}

cc_expect <- ccare %>%
  filter (Week == 7| Week == 8) %>%
  summarise (n = n(), 
            sibling = sum(expect_relation_sibling, na.rm = TRUE)/n*100,
             grandparent = sum(expect_relation_grand, na.rm = TRUE)/n*100,
             auntuncle = sum(expect_relation_aunt, na.rm = TRUE)/n*100,
             othrelative = sum(expect_relation_relative, na.rm = TRUE)/n*100,
             friend = sum(expect_relation_friend, na.rm = TRUE)/n*100,
             neighbor = sum(expect_relation_neighbor, na.rm = TRUE)/n*100
             ) %>%
  pivot_longer(cols = c("sibling","grandparent", "auntuncle", "othrelative", "friend", "neighbor"), names_to = "ExpectMethod", values_to = "Percent" )

  
cc_expect %>%
  ggplot ( mapping = aes (x = Percent, y = ExpectMethod)) +
  geom_col(position = 'dodge') + 
  geom_text(aes(label = round (Percent,2)),vjust = 1.6, color = "white")+
  xlim (0,25) +
  coord_flip()
```
