---
title: "Online Learning & Technology - Complete Analyses"
author: "Sihong"
date: "1/11/2021"
output:
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, include = FALSE}
library(here)
library(knitr)
library(readr)
library(haven)
library(tidyverse)
```


```{r, echo=FALSE, message = FALSE}
#Define functions
moe.p = function(p, n){
  q = 1-p
  moe = 1.96*sqrt((p*q)/n)
  return(moe)
}

moe.m = function(sd,n){
  moe = 1.96*sd/sqrt(n)
  return(moe)}

combine.cat = function(x, cols, id, newvar.name){
  subset = x[,c(id, "Week", cols)]
  names(subset) = c("id", "Week", paste0("X",1:length(cols)))
  subset = suppressWarnings(gather(subset, "key", "value", -id, -Week))
  subset = filter(subset, !is.na(value))
  subset$key = gsub("X", "", subset$key)
  subset = group_by(subset, id, Week)
  subset = summarise(subset, newvar = paste(key, collapse = ",")) %>% ungroup()
  names(subset) = c(id,"Week", newvar.name)
  x = suppressMessages(full_join(x, subset))
  return(x)
}

find_items = function(string, data2){
  items = names(data2)
  locations = which(grepl(string, items))
  final = items[locations]
  return(final)
}

my.max = function(x) ifelse (!all(is.na(x)), max(x,na.rm = TRUE), NA)
my.min = function(x) ifelse (!all(is.na(x)), min(x,na.rm = TRUE), NA)
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
#OR load master data file
master <- read_sav(here("../../Data Management R3/CC_Clean Survey Data/00_R3 MasterFile/MasterFile_groupings.sav"))


# Remove cases should be excluded
master <- master %>%
  filter ( CaregiverID != "" & is.na(Exclude) == T)

master = master %>%
  group_by(CaregiverID, Week) %>%
  filter(row_number() == max(row_number())) %>%
  ungroup()

total_week <- max(master$Week)

```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
#Code demographics
master <- master %>%
  mutate (month = case_when(
                  Week == 0 ~ "Pre-COVID",
                  Week >0 & Week <= 4 ~ "April",
                  Week >=5 & Week <=8 ~ "May",
                  Week >=9 & Week <=13 ~ "June",
                  Week >=14 & Week <=17 ~ "July",
                  Week >=18 & Week <=21 ~ "August",
                  Week >=22 & Week <=26 ~ "September",
                  Week >=27 ~ "October"), 
           baseline = case_when (Week - BaselineWeek == 1 ~ 1, 
                                 Week - BaselineWeek > 1 ~ 0))

##Race/ethnicity - 1 = black, 2 = latinx, 3 = white

master <- master %>%
  mutate (RaceGroup = na_if (RaceGroup, 99))%>%
    mutate(
      minority = ifelse(RaceGroup != 5, 1, 0),
      black = ifelse(RaceGroup == 3, 1, 0),
      native = ifelse(RaceGroup == 1, 1, 0),
      asian = ifelse(RaceGroup == 2, 1, 0),
      hawaii = ifelse(RaceGroup == 4, 1, 0),
      white = ifelse(RaceGroup == 5, 1, 0),
      other_race = ifelse(RaceGroup %in% c(6, 7), 1, 0))

master <- master %>%
      mutate(latinx = case_when(
        DEMO.008 == 1 ~ 1,
        DEMO.008 == 0 ~ 0,
        DEMO.008.2 == 0 ~ 0,
        DEMO.008.2 == 1 ~ 1,
        DEMO.008.2 == 2 ~ 1,
        TRUE ~ NA_real_))

master <- master %>%
mutate (race_ethnic = case_when(
      black == 1 ~ "1",
      latinx == 1 ~ "2",
      !is.na(black) ~ "3",
      !is.na(latinx) ~ "3",
      TRUE ~ NA_character_))  

##Povertyline - 0 = high income, 1 = low income
master <- master %>%
  mutate (poverty_cat = FPL.2019.UM.150)

#Material hardship
master <- master %>%
  combine.cat(cols = find_items("FSTR.002_.{1}$", master), 
              id = "CaregiverID",
              newvar.name = "FSTR.002_cat")
  

master <- master %>%
  mutate (diff_pay_food = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("1", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_), 
          diff_pay_utilities = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("3", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_house = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("2", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_healthcare = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("4", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_social = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("5", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_emotional = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("6", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_childcare = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("7", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_other = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("8", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_))

master <- master %>%
  rowwise() %>%
  mutate(material_hardship = case_when(
    Week == 0 ~ NA_real_,
    TRUE ~ sum(c_across(starts_with("diff_pay_")), na.rm=T))) %>%
  ungroup() %>%
  mutate(num_hardship = material_hardship,
    material_hardship = ifelse(material_hardship > 0, 1, 0)) 

## Children with special needs
master <- combine.cat(x = master, 
                       cols = find_items("HEALTH.005_[0-9]{1}$", master), 
                       id = "CaregiverID",
                       newvar.name = "HEALTH.005_cat")
master <- master %>%
   mutate (disability = case_when (HEALTH.005_1 == 1 ~ 1,
                                   HEALTH.005_2 == 1 ~ 1,
                                   HEALTH.005_3 == 1 ~ 1,
                                   HEALTH.005_4 == 1 ~ 1,
                                   HEALTH.005_5 == 1 ~ 0,
                                   HEALTH.005_6 == 1 ~ 1,
                                   TRUE ~ NA_real_))


## Single parent status
master <- master %>%
  mutate (single = case_when (
                   DEMO.002 %in% c(3,4,5,7,8)~1, 
                   DEMO.011 %in% c(2,4)~1,
                   !is.na(DEMO.002)~0,
                   !is.na(DEMO.011)~0,
                   TRUE ~ NA_real_))
                     
## Employment status
master <- combine.cat (x = master,
                       cols = find_items ("JOB.010_.{1,2}$", master), 
                       id = "CaregiverID",
                       newvar.name = "JOB.010_cat")
  
master$JOB.010_cat = gsub("10", "0", master$JOB.010_cat)
master$working_pre = ifelse (grepl("[1,2,6]", master$JOB.010_cat), 1, 0)
master = combine.cat (x = master,
                       cols = find_items ("JOB.008_.{1,2}$", master), 
                       id = "CaregiverID",
                       newvar.name = "JOB.008_cat")
master$JOB.008_cat = gsub("10", "0", master$JOB.008_cat)
master <- master %>%
  mutate (work_status = case_when(
                        grepl ("1", JOB.008_cat) ~ "1", 
                        grepl ("2", JOB.008_cat) ~ "1", 
                        grepl ("3", JOB.008_cat) ~ "0", 
                        grepl ("4", JOB.008_cat) ~ "0", 
                        grepl ("5", JOB.008_cat) ~ "1", 
                        JOB.008.2 == 1 ~ "1",
                        JOB.008.2 %in% c(2,3) ~ "0",
                        TRUE~NA_character_),
          work_status_pre = case_when(
                        grepl ("1", JOB.010_cat) ~ "1", 
                        grepl ("2", JOB.010_cat) ~ "1", 
                        grepl ("3", JOB.010_cat) ~ "0", 
                        grepl ("4", JOB.010_cat) ~ "0", 
                        grepl ("5", JOB.010_cat) ~ "1", 
                        TRUE~NA_character_))
#1 = stable employed 2 = became unemployed 3 = became employed4 = stable unemployed

# Region
master <- master %>%
  mutate (region = na_if (DEMO.001.b, 5))

master_dem <- master %>%
  group_by (CaregiverID) %>%
  summarise (BaselineWeek = my.max (BaselineWeek),
             race_ethnic = my.max(race_ethnic),
             poverty_cat = my.max(poverty_cat),
             material_hardship = my.max(material_hardship),
             disability = my.max (disability),
             single = my.max (single),
             work_status = my.max (work_status),
             work_status_pre = my.max (work_status_pre), 
             region = my.max(region))%>%
  mutate ( ep_change = case_when(
                        work_status == 1 & work_status_pre == 1 ~ "1", 
                        work_status == 1 & work_status_pre == 0 ~ "2", 
                        work_status == 0 & work_status_pre == 1 ~ "3", 
                        work_status == 0 & work_status_pre == 0 ~ "4", 
                        TRUE~NA_character_))%>%
  mutate (race_ethnic = case_when (
                        race_ethnic == 1 ~ "Black", 
                        race_ethnic == 2 ~ "Latinx", 
                        race_ethnic == 3 ~ "White", 
                        TRUE~NA_character_),
          poverty_cat = case_when (
                        poverty_cat == 1 ~ "Low income", 
                        poverty_cat == 0 ~ "High income", 
                        TRUE~NA_character_),
          material_hardship = case_when (
                        material_hardship == 1 ~ "With material hardship", 
                        material_hardship == 0 ~ "Without material hardship", 
                        TRUE~NA_character_),
          disability = case_when (
                        disability == 1 ~ "With disability", 
                        disability == 0 ~ "Without disability", 
                        TRUE~NA_character_),
          single = case_when (
                        single == 1 ~ "Single parent", 
                        single == 0 ~ "Dual parent", 
                        TRUE~NA_character_),
          work_status = case_when (
                        work_status == 1 ~ "Employed", 
                        work_status == 0 ~ "Unemployed", 
                        TRUE~NA_character_),
          work_status_pre = case_when (
                        work_status_pre == 1 ~ "Employed", 
                        work_status_pre == 0 ~ "Unemployed", 
                        TRUE~NA_character_),
          ep_change = case_when (
                        ep_change == 1 ~ "Stable employed", 
                        ep_change == 2 ~ "Became employed", 
                        ep_change == 3 ~ "Became unemployed",
                        ep_change == 4 ~ "Stable unemployed",
                        TRUE~NA_character_), 
          region = case_when (
                        region == 1 ~ "Northeast", 
                        region == 2 ~ "Midwest", 
                        region == 3 ~ "South", 
                        region == 4 ~ "West",
                        TRUE~NA_character_))

```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
# Extract Relevant Variables
##RL questions - online learning

rl <- master %>%
  select (CaregiverID, Week, baseline, starts_with ("RL."), starts_with ("INTERNET") )%>%
  filter (Week == 37 | Week == 39)

rl <- merge (x = master_dem, y = rl,  by.x = "CaregiverID", by.y = "CaregiverID", all.y = T) %>%
  group_by (CaregiverID)%>%
  filter (Week == max (Week))%>%
  ungroup()


```

# 0. Sample Disclaimer
  * Remote Learning are based on responses collected from 1,577 caregivers between the dates of December 14th, 2020 and January 7th, 2021. These caregivers represent a range of voices: 9.32% are Black/African American, 13.20% are Latinx, and 24.62% live at or below 1.5 times the federal poverty line. Among this sample, there was 756 families reporting having at least one child(ren) in pre-school/pre-K, and 605 families reporting having at least one child(ren) in K-12. In these families, there were 220 caregivers reporting that their pre-school/pre-K children were using remote learning, and 414 caregivers reporting that their K-12 children were using remote learning. Proportions/percentages are calculated based on the item-level response rates, not out of the total sample size. The data for these analyses are not weighted. \

```{r, echo=FALSE, message = FALSE, warning = FALSE, results = FALSE}
library(janitor)
tabyl(rl$race_ethnic)
tabyl(rl$poverty_cat)
```

# 1. Overall Remote Learning Options

## 1.1 COVID Influences in Education Overall

  * Question: Overall, how has the coronavirus (COVID-19) pandemic affected how your child(ren) in pre-school/pre-K receive education for the 2020-2021 school year? \
    + Classes normally taught in person at the school were canceled\
    + Classes normally taught in person moved to a distance-learning format using online resources, either self-paced or in real time\
    + Classes normally taught in person moved to a distance-learning format using paper materials sent home to children\
    + Classes normally taught in person changed in some other way\
    + The coronavirus pandemic did not affect how children in this house receive education

### 1.1.1 Pre-school/Pre-K (n = 756)

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.010_1 == 1)%>%
  summarise (n = n(),
             cancel = sum(RL.011.a_1, na.rm = T)/n, 
             move_online = sum(RL.011.a_2, na.rm = T)/n, 
             move_paper = sum(RL.011.a_3, na.rm = T)/n, 
             change_otherway = sum(RL.011.a_4, na.rm = T)/n, 
             no_change = sum(RL.011.a_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("cancel", "move_online", "move_paper", "change_otherway", "no_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K, n = 756")
```

#### 1.1.1.1 By race_ethnicity

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.010_1 == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             cancel = sum(RL.011.a_1, na.rm = T)/n, 
             move_online = sum(RL.011.a_2, na.rm = T)/n, 
             move_paper = sum(RL.011.a_3, na.rm = T)/n, 
             change_otherway = sum(RL.011.a_4, na.rm = T)/n, 
             no_change = sum(RL.011.a_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("cancel", "move_online", "move_paper", "change_otherway", "no_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K, n = 756")+
  facet_wrap (~conditions, nrow = 5)
```

#### 1.1.1.2 By poverty level

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.010_1 == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             cancel = sum(RL.011.a_1, na.rm = T)/n, 
             move_online = sum(RL.011.a_2, na.rm = T)/n, 
             move_paper = sum(RL.011.a_3, na.rm = T)/n, 
             change_otherway = sum(RL.011.a_4, na.rm = T)/n, 
             no_change = sum(RL.011.a_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("cancel", "move_online", "move_paper", "change_otherway", "no_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K, n = 756")
```


### 1.1.2 K-12 (N = 605)

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.010_2 == 1)%>%
  summarise (n = n(),
             cancel = sum(RL.011.b_1, na.rm = T)/n, 
             move_online = sum(RL.011.b_2, na.rm = T)/n, 
             move_paper = sum(RL.011.b_3, na.rm = T)/n, 
             change_otherway = sum(RL.011.b_4, na.rm = T)/n, 
             no_change = sum(RL.011.b_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("cancel", "move_online", "move_paper", "change_otherway", "no_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "k-12, n = 605")
```

#### 1.1.2.1 By race/ethnicity

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.010_2 == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             cancel = sum(RL.011.b_1, na.rm = T)/n, 
             move_online = sum(RL.011.b_2, na.rm = T)/n, 
             move_paper = sum(RL.011.b_3, na.rm = T)/n, 
             change_otherway = sum(RL.011.b_4, na.rm = T)/n, 
             no_change = sum(RL.011.b_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("cancel", "move_online", "move_paper", "change_otherway", "no_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "k-12, n = 605")+
  facet_wrap (~conditions, nrow = 5)
```

#### 1.1.2.2 By poverty level - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.010_2 == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             cancel = sum(RL.011.b_1, na.rm = T)/n, 
             move_online = sum(RL.011.b_2, na.rm = T)/n, 
             move_paper = sum(RL.011.b_3, na.rm = T)/n, 
             change_otherway = sum(RL.011.b_4, na.rm = T)/n, 
             no_change = sum(RL.011.b_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("cancel", "move_online", "move_paper", "change_otherway", "no_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "k-12, n = 605")
```

## 1.2 Options by Schools and Caregivers' Choices

  * Did the school district your pre-school/pre-k/k-12 children is enrolled in for 2020-2021 offer a choice between in-person, hybrid, or remote learning? - Yes/no\
  * (If selected yes) Which one did you choose for your children?\
    + In-person\
    + Hybrid \
    + Remote learning\
    + None of the above (specify)\
  * Did the learning options the school district where your children are in offered change after the 2020-2021 school year had started (around August/September 2020)? - yes/no\
  * (If selected yes) Did you select a different choice for your children when the school district offered the changes? And why? - yes/no\
  

### 1.2.1 Pre-school/Pre-K (n = 756)

  * For pre-school/pre-k, there were 43.46% of caregivers reporting that their children's school offered different options. And there were 15.74% choosing in-person, 14.19% choosing remote learning, 5.54% choosing hybrid, and 7.98% reporting choosing none of the above options. \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (RL.013.a_1 = ifelse (RL.013.a == 1, 1, 0), 
          RL.013.a_2 = ifelse (RL.013.a == 2, 1, 0), 
          RL.013.a_3 = ifelse (RL.013.a == 3, 1, 0), 
          RL.013.a_4 = ifelse (RL.013.a == 4, 1, 0))%>%
  filter (RL.010_1 == 1)%>%
  summarise (n = n(),
             a.not_offering_options = 1-sum (RL.012.a,na.rm = T)/n,
             b.choose_inprson = sum (RL.013.a_1, na.rm = T)/n,
             c.hybrid = sum (RL.013.a_2, na.rm = T)/n,
             d.remote_learning = sum (RL.013.a_3, na.rm = T)/n,
             e.none_of_above = sum (RL.013.a_4, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_offering_options", "b.choose_inprson", "c.hybrid", "d.remote_learning", "e.none_of_above"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K school options, n = 756")
```

  * Since the new school year began (August/September), there were 35.03% families reporting that pre-school/pre-K changed the options they offered for children's learning, but only 8.20% of caregivers selected a different choice.\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (RL.016.a_1 = ifelse (RL.016.a == 0, 1, 0))%>%
  filter (RL.010_1 == 1)%>%
  summarise (n = n(),
             a.not_change_options = 1-sum (RL.015.a,na.rm = T)/n,
             b.change_school_options = sum (RL.016.a, na.rm = T)/n,
             c.offered_but_not_change = sum (RL.016.a_1, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_change_options", "b.change_school_options", "c.offered_but_not_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K change options, n = 756")
```

#### 1.2.1.1 By race/ethnicity
  
  * Options from school\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (RL.013.a_1 = ifelse (RL.013.a == 1, 1, 0), 
          RL.013.a_2 = ifelse (RL.013.a == 2, 1, 0), 
          RL.013.a_3 = ifelse (RL.013.a == 3, 1, 0), 
          RL.013.a_4 = ifelse (RL.013.a == 4, 1, 0))%>%
  filter (RL.010_1 == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.not_offering_options = 1-sum (RL.012.a,na.rm = T)/n,
             b.choose_inprson = sum (RL.013.a_1, na.rm = T)/n,
             c.hybrid = sum (RL.013.a_2, na.rm = T)/n,
             d.remote_learning = sum (RL.013.a_3, na.rm = T)/n,
             e.none_of_above = sum (RL.013.a_4, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_offering_options", "b.choose_inprson", "c.hybrid", "d.remote_learning", "e.none_of_above"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K school options, n = 756")+
  facet_wrap (~conditions, nrow = 5)
```

  * Options parents chose - no sig. group difference \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (RL.016.a_1 = ifelse (RL.016.a == 0, 1, 0))%>%
  filter (RL.010_1 == 1)%>%
    filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.not_change_options = 1-sum (RL.015.a,na.rm = T)/n,
             b.change_school_options = sum (RL.016.a, na.rm = T)/n,
             c.offered_but_not_change = sum (RL.016.a_1, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_change_options", "b.change_school_options", "c.offered_but_not_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K change options, n = 756")+
  facet_wrap (~conditions, nrow = 3)
```

#### 1.2.1.2 By poverty level 

  * Options from school\
    
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (RL.013.a_1 = ifelse (RL.013.a == 1, 1, 0), 
          RL.013.a_2 = ifelse (RL.013.a == 2, 1, 0), 
          RL.013.a_3 = ifelse (RL.013.a == 3, 1, 0), 
          RL.013.a_4 = ifelse (RL.013.a == 4, 1, 0))%>%
  filter (RL.010_1 == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.not_offering_options = 1-sum (RL.012.a,na.rm = T)/n,
             b.choose_inprson = sum (RL.013.a_1, na.rm = T)/n,
             c.hybrid = sum (RL.013.a_2, na.rm = T)/n,
             d.remote_learning = sum (RL.013.a_3, na.rm = T)/n,
             e.none_of_above = sum (RL.013.a_4, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_offering_options", "b.choose_inprson", "c.hybrid", "d.remote_learning", "e.none_of_above"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K school options, n = 756")
```

  * Options parents chose - no sig. group difference \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (RL.016.a_1 = ifelse (RL.016.a == 0, 1, 0))%>%
  filter (RL.010_1 == 1)%>%
    filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.not_change_options = 1-sum (RL.015.a,na.rm = T)/n,
             b.change_school_options = sum (RL.016.a, na.rm = T)/n,
             c.offered_but_not_change = sum (RL.016.a_1, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_change_options", "b.change_school_options", "c.offered_but_not_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K change options, n = 756")
```

### 1.2.2 K-12 (n = 605)

  * For families with K-12 children, there were 73.72% of caregivers reporting that their children's school offered different options. And there were 25.45% choosing in-person, 27.77% choosing remote learning, 13.55% choosing hybrid, and 6.94% reporting choosing none of the above options.\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (RL.013.b_1 = ifelse (RL.013.b == 1, 1, 0), 
          RL.013.b_2 = ifelse (RL.013.b == 2, 1, 0), 
          RL.013.b_3 = ifelse (RL.013.b == 3, 1, 0), 
          RL.013.b_4 = ifelse (RL.013.b == 4, 1, 0), 
          RL.012.b = case_when (RL.012.b == 1 ~ 1,
                                RL.012.b == 2 ~ 0))%>%
  filter (RL.010_2 == 1)%>%
  summarise (n = n(),
             a.not_offering_options = 1-sum (RL.012.b,na.rm = T)/n,
             b.choose_inprson = sum (RL.013.b_1, na.rm = T)/n,
             c.hybrid = sum (RL.013.b_2, na.rm = T)/n,
             d.remote_learning = sum (RL.013.b_3, na.rm = T)/n,
             e.none_of_above = sum (RL.013.b_4, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_offering_options", "b.choose_inprson", "c.hybrid", "d.remote_learning", "e.none_of_above"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 school options, n = 605")
```

  * Since the new school year began (August/September), there were 50.41% families reporting that pre-school/pre-K changed the options they offered for children's learning, but only 13.72% of caregivers selected a different choice.\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (RL.016.b = case_when (RL.016.b == 1 ~ 1,
                                RL.016.b == 2 ~ 0),
          RL.016.b_1 = ifelse (RL.016.b == 0, 1, 0), 
          RL.015.b = case_when (RL.015.b == 1 ~ 1,
                                RL.015.b == 2 ~ 0))%>%
  filter (RL.010_2 == 1)%>%
  summarise (n = n(),
             a.not_change_options = 1-sum (RL.015.b,na.rm = T)/n,
             b.change_school_options = sum (RL.016.b, na.rm = T)/n,
             c.offered_but_not_change = sum (RL.016.b_1, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_change_options", "b.change_school_options", "c.offered_but_not_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 change options, n = 605")
```

  * School enrollment: for families with children in K-12, majority of children (75.37%) were enrolled in public school \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (a.public_school = ifelse (RL.017 == 1, 1, 0), 
          b.private_school = ifelse (RL.017 == 2, 1, 0), 
          c.home_school = ifelse (RL.017 == 3, 1, 0), 
          d.other = ifelse (RL.017 == 4, 1, 0), )%>%
  filter (RL.010_2 == 1)%>%
  summarise (n = n(),
             a.public_school = sum (a.public_school,na.rm = T)/n,
             b.private_school = sum (b.private_school, na.rm = T)/n,
             c.home_school = sum (c.home_school, na.rm = T)/n, 
             d.other= sum (d.other, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.public_school", "b.private_school", "c.home_school", "d.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 school enrollment, n = 605")
```

#### 1.2.2.1 By race/ethnicity

  * Options from school\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (RL.013.b_1 = ifelse (RL.013.b == 1, 1, 0), 
          RL.013.b_2 = ifelse (RL.013.b == 2, 1, 0), 
          RL.013.b_3 = ifelse (RL.013.b == 3, 1, 0), 
          RL.013.b_4 = ifelse (RL.013.b == 4, 1, 0), 
          RL.012.b = case_when (RL.012.b == 1 ~ 1,
                                RL.012.b == 2 ~ 0))%>%
  filter (RL.010_2 == 1)%>%
    filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.not_offering_options = 1-sum (RL.012.b,na.rm = T)/n,
             b.choose_inprson = sum (RL.013.b_1, na.rm = T)/n,
             c.hybrid = sum (RL.013.b_2, na.rm = T)/n,
             d.remote_learning = sum (RL.013.b_3, na.rm = T)/n,
             e.none_of_above = sum (RL.013.b_4, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_offering_options", "b.choose_inprson", "c.hybrid", "d.remote_learning", "e.none_of_above"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 school options, n = 605")+
  facet_wrap (~conditions, nrow = 5)
```
  
  * Options parents chose - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (RL.016.b = case_when (RL.016.b == 1 ~ 1,
                                RL.016.b == 2 ~ 0),
          RL.016.b_1 = ifelse (RL.016.b == 0, 1, 0), 
          RL.015.b = case_when (RL.015.b == 1 ~ 1,
                                RL.015.b == 2 ~ 0))%>%
  filter (RL.010_2 == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.not_change_options = 1-sum (RL.015.b,na.rm = T)/n,
             b.change_school_options = sum (RL.016.b, na.rm = T)/n,
             c.offered_but_not_change = sum (RL.016.b_1, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_change_options", "b.change_school_options", "c.offered_but_not_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 change options-no sig. group difference, n = 605")+
  facet_wrap (~conditions, nrow = 3)
```
  
  * School enrollment\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (a.public_school = ifelse (RL.017 == 1, 1, 0), 
          b.private_school = ifelse (RL.017 == 2, 1, 0), 
          c.home_school = ifelse (RL.017 == 3, 1, 0), 
          d.other = ifelse (RL.017 == 4, 1, 0), )%>%
  filter (RL.010_2 == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.public_school = sum (a.public_school,na.rm = T)/n,
             b.private_school = sum (b.private_school, na.rm = T)/n,
             c.home_school = sum (c.home_school, na.rm = T)/n, 
             d.other= sum (d.other, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.public_school", "b.private_school", "c.home_school", "d.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -0.5, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 school enrollment, n = 605")+
  facet_wrap (~conditions, nrow = 2)
```

#### 1.2.2.2 By poverty level

  * Options school offered - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (RL.013.b_1 = ifelse (RL.013.b == 1, 1, 0), 
          RL.013.b_2 = ifelse (RL.013.b == 2, 1, 0), 
          RL.013.b_3 = ifelse (RL.013.b == 3, 1, 0), 
          RL.013.b_4 = ifelse (RL.013.b == 4, 1, 0), 
          RL.012.b = case_when (RL.012.b == 1 ~ 1,
                                RL.012.b == 2 ~ 0))%>%
  filter (RL.010_2 == 1)%>%
    filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.not_offering_options = 1-sum (RL.012.b,na.rm = T)/n,
             b.choose_inprson = sum (RL.013.b_1, na.rm = T)/n,
             c.hybrid = sum (RL.013.b_2, na.rm = T)/n,
             d.remote_learning = sum (RL.013.b_3, na.rm = T)/n,
             e.none_of_above = sum (RL.013.b_4, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_offering_options", "b.choose_inprson", "c.hybrid", "d.remote_learning", "e.none_of_above"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 school options, n = 605")
```

  * options parents chose - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (RL.016.b = case_when (RL.016.b == 1 ~ 1,
                                RL.016.b == 2 ~ 0),
          RL.016.b_1 = ifelse (RL.016.b == 0, 1, 0), 
          RL.015.b = case_when (RL.015.b == 1 ~ 1,
                                RL.015.b == 2 ~ 0))%>%
  filter (RL.010_2 == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.not_change_options = 1-sum (RL.015.b,na.rm = T)/n,
             b.change_school_options = sum (RL.016.b, na.rm = T)/n,
             c.offered_but_not_change = sum (RL.016.b_1, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.not_change_options", "b.change_school_options", "c.offered_but_not_change"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 change options, n = 605")
```

  * School enrollment\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (a.public_school = ifelse (RL.017 == 1, 1, 0), 
          b.private_school = ifelse (RL.017 == 2, 1, 0), 
          c.home_school = ifelse (RL.017 == 3, 1, 0), 
          d.other = ifelse (RL.017 == 4, 1, 0), )%>%
  filter (RL.010_2 == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.public_school = sum (a.public_school,na.rm = T)/n,
             b.private_school = sum (b.private_school, na.rm = T)/n,
             c.home_school = sum (c.home_school, na.rm = T)/n, 
             d.other= sum (d.other, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.public_school", "b.private_school", "c.home_school", "d.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 school enrollment, n = 605")
```

# 2. Access to Internet and Technology

## 2.1 Equipment
 
  * RL.021.a/b What type of device(s) does your children in pre-school/pre-K/K-12 use for remote learning? Select all that apply\
    + A tablet\
    + Smart phone\
    + Laptop computer\
    + Desktop computer\
    + Other, specify\
  * RL.022-026.a/b Is the computer or other digital devices...? Select all that apply: \
    + Provided by the children's school or school district to use outside of school\
    + Provided by someone in the household or family, or it is the child's\
    + Provided by another source\

### 2.1.1 Pre-school/Pre-K
  
  * What equipment children have access to\

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.a_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.a_2, na.rm = T)/n,
             c.laptop = sum (RL.021.a_3, na.rm = T)/n,
             d.desktop = sum (RL.021.a_4, na.rm = T)/n,
             e.other = sum (RL.021.a_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K equipment used, n = 220")
```

  * Who provided the equipment & What equipment school provided
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (c.school = ifelse ((RL.022.a == 1 | RL.023.a == 1 | RL.024.a == 1 | RL.025.a == 1 | RL.026.a == 1), 1, 0), 
          b.household = ifelse ((RL.022.a == 2 | RL.023.a == 2 | RL.024.a == 2 | RL.025.a == 2 | RL.026.a == 2), 1, 0), 
          a.other = ifelse ((RL.022.a == 3 | RL.023.a == 3 | RL.024.a == 3 | RL.025.a == 3 | RL.026.a == 3), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             c.school = sum (c.school,na.rm = T)/n,
             b.household = sum (b.household, na.rm = T)/n,
             a.other = sum (a.other, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("c.school", "b.household", "a.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K Who provided the equipment, n = 220")



rl_prek <- rl %>%
  mutate (school = ifelse ((RL.022.a == 1 | RL.023.a == 1 | RL.024.a == 1 | RL.025.a == 1 | RL.026.a == 1), 1, 0), 
          household = ifelse ((RL.022.a == 2 | RL.023.a == 2 | RL.024.a == 2 | RL.025.a == 2 | RL.026.a == 2), 1, 0), 
          other = ifelse ((RL.022.a == 3 | RL.023.a == 3 | RL.024.a == 3 | RL.025.a == 3 | RL.026.a == 3), 1, 0))%>%
  filter (RL.001.a == 1 & school == 1)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.a_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.a_2, na.rm = T)/n,
             c.laptop = sum (RL.021.a_3, na.rm = T)/n,
             d.desktop = sum (RL.021.a_4, na.rm = T)/n,
             e.other = sum (RL.021.a_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K What equipment school provided, n = 75")
```

#### 2.1.1.1 By race_ethnicity

  *What equipment children have access to - no sig. group difference\

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.a_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.a_2, na.rm = T)/n,
             c.laptop = sum (RL.021.a_3, na.rm = T)/n,
             d.desktop = sum (RL.021.a_4, na.rm = T)/n,
             e.other = sum (RL.021.a_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K what equipment used, n = 220")+
  facet_wrap (~conditions, nrow = 5)
```

  * Who provided the equipment & What equipment school provided\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (c.school = ifelse ((RL.022.a == 1 | RL.023.a == 1 | RL.024.a == 1 | RL.025.a == 1 | RL.026.a == 1), 1, 0), 
          b.household = ifelse ((RL.022.a == 2 | RL.023.a == 2 | RL.024.a == 2 | RL.025.a == 2 | RL.026.a == 2), 1, 0), 
          a.other = ifelse ((RL.022.a == 3 | RL.023.a == 3 | RL.024.a == 3 | RL.025.a == 3 | RL.026.a == 3), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             c.school = sum (c.school,na.rm = T)/n,
             b.household = sum (b.household, na.rm = T)/n,
             a.other = sum (a.other, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("c.school", "b.household", "a.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K Who provided the equipment, n = 220")+
  facet_wrap (~conditions, nrow = 3)
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (school = ifelse ((RL.022.a == 1 | RL.023.a == 1 | RL.024.a == 1 | RL.025.a == 1 | RL.026.a == 1), 1, 0), 
          household = ifelse ((RL.022.a == 2 | RL.023.a == 2 | RL.024.a == 2 | RL.025.a == 2 | RL.026.a == 2), 1, 0), 
          other = ifelse ((RL.022.a == 3 | RL.023.a == 3 | RL.024.a == 3 | RL.025.a == 3 | RL.026.a == 3), 1, 0))%>%
  filter (RL.001.a == 1 & school == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.a_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.a_2, na.rm = T)/n,
             c.laptop = sum (RL.021.a_3, na.rm = T)/n,
             d.desktop = sum (RL.021.a_4, na.rm = T)/n,
             e.other = sum (RL.021.a_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-k What equipment school provided - no sig. group diff., n = 75")+
  facet_wrap (~conditions, nrow = 5)
```

#### 2.1.1.2 By poverty level

  *What equipment children have access to - no sig. group difference\

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.a_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.a_2, na.rm = T)/n,
             c.laptop = sum (RL.021.a_3, na.rm = T)/n,
             d.desktop = sum (RL.021.a_4, na.rm = T)/n,
             e.other = sum (RL.021.a_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K what equipment used, n = 220")
```

  * Who provided the equipment & What equipment school provided\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (c.school = ifelse ((RL.022.a == 1 | RL.023.a == 1 | RL.024.a == 1 | RL.025.a == 1 | RL.026.a == 1), 1, 0), 
          b.household = ifelse ((RL.022.a == 2 | RL.023.a == 2 | RL.024.a == 2 | RL.025.a == 2 | RL.026.a == 2), 1, 0), 
          a.other = ifelse ((RL.022.a == 3 | RL.023.a == 3 | RL.024.a == 3 | RL.025.a == 3 | RL.026.a == 3), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             c.school = sum (c.school,na.rm = T)/n,
             b.household = sum (b.household, na.rm = T)/n,
             a.other = sum (a.other, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("c.school", "b.household", "a.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K who provided equipment, n = 220")
```


```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (school = ifelse ((RL.022.a == 1 | RL.023.a == 1 | RL.024.a == 1 | RL.025.a == 1 | RL.026.a == 1), 1, 0), 
          household = ifelse ((RL.022.a == 2 | RL.023.a == 2 | RL.024.a == 2 | RL.025.a == 2 | RL.026.a == 2), 1, 0), 
          other = ifelse ((RL.022.a == 3 | RL.023.a == 3 | RL.024.a == 3 | RL.025.a == 3 | RL.026.a == 3), 1, 0))%>%
  filter (RL.001.a == 1 & school == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.a_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.a_2, na.rm = T)/n,
             c.laptop = sum (RL.021.a_3, na.rm = T)/n,
             d.desktop = sum (RL.021.a_4, na.rm = T)/n,
             e.other = sum (RL.021.a_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K what equipment school provided - no sig. group dif, n = 75")
```

### 2.1.2 K-12

  * What equipment children have access to\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.b_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.b_2, na.rm = T)/n,
             c.laptop = sum (RL.021.b_3, na.rm = T)/n,
             d.desktop = sum (RL.021.b_4, na.rm = T)/n,
             e.other = sum (RL.021.b_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 what equipment used, n = 414")
```

  * Who provided the equipment & What equipment school provided\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (c.school = ifelse ((RL.022.b == 1 | RL.023.b == 1 | RL.024.b == 1 | RL.025.b== 1 | RL.026.b == 1), 1, 0), 
          b.household = ifelse ((RL.022.b == 2 | RL.023.b == 2 | RL.024.b == 2 | RL.025.b == 2 | RL.026.b == 2), 1, 0), 
          a.other = ifelse ((RL.022.b == 3 | RL.023.b == 3 | RL.024.b == 3 | RL.025.b== 3 | RL.026.b == 3), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             c.school = sum (c.school,na.rm = T)/n,
             b.household = sum (b.household, na.rm = T)/n,
             a.other = sum (a.other, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("c.school", "b.household", "a.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 who provided equipment, n = 414")


rl_K12 <- rl %>%
  mutate (school = ifelse ((RL.022.b == 1 | RL.023.b == 1 | RL.024.b == 1 | RL.025.b== 1 | RL.026.b == 1), 1, 0), 
          household = ifelse ((RL.022.b == 2 | RL.023.b == 2 | RL.024.b == 2 | RL.025.b == 2 | RL.026.b == 2), 1, 0), 
          other = ifelse ((RL.022.b == 3 | RL.023.b == 3 | RL.024.b == 3 | RL.025.b== 3 | RL.026.b == 3), 1, 0))%>%
  filter (RL.001.b == 1 & school == 1)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.b_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.b_2, na.rm = T)/n,
             c.laptop = sum (RL.021.b_3, na.rm = T)/n,
             d.desktop = sum (RL.021.b_4, na.rm = T)/n,
             e.other = sum (RL.021.b_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 what equipment school provided, n = 296")
```

### 2.1.2.1 By race/ethnicity

  * What equipment children have access to\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.b_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.b_2, na.rm = T)/n,
             c.laptop = sum (RL.021.b_3, na.rm = T)/n,
             d.desktop = sum (RL.021.b_4, na.rm = T)/n,
             e.other = sum (RL.021.b_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 what equipment used, n = 414")+
  facet_wrap (~conditions, nrow = 5)
```

  * Who provided the equipment & What equipment school provided\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (c.school = ifelse ((RL.022.b == 1 | RL.023.b == 1 | RL.024.b == 1 | RL.025.b== 1 | RL.026.b == 1), 1, 0), 
          b.household = ifelse ((RL.022.b == 2 | RL.023.b == 2 | RL.024.b == 2 | RL.025.b == 2 | RL.026.b == 2), 1, 0), 
          a.other = ifelse ((RL.022.b == 3 | RL.023.b == 3 | RL.024.b == 3 | RL.025.b== 3 | RL.026.b == 3), 1, 0))%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             c.school = sum (c.school,na.rm = T)/n,
             b.household = sum (b.household, na.rm = T)/n,
             a.other = sum (a.other, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("c.school", "b.household", "a.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 Who provided equipment, n = 414")+
  facet_wrap (~conditions, nrow = 3)


rl_K12 <- rl %>%
  mutate (school = ifelse ((RL.022.b == 1 | RL.023.b == 1 | RL.024.b == 1 | RL.025.b== 1 | RL.026.b == 1), 1, 0), 
          household = ifelse ((RL.022.b == 2 | RL.023.b == 2 | RL.024.b == 2 | RL.025.b == 2 | RL.026.b == 2), 1, 0), 
          other = ifelse ((RL.022.b == 3 | RL.023.b == 3 | RL.024.b == 3 | RL.025.b== 3 | RL.026.b == 3), 1, 0))%>%
  filter (RL.001.b == 1 & school == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.b_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.b_2, na.rm = T)/n,
             c.laptop = sum (RL.021.b_3, na.rm = T)/n,
             d.desktop = sum (RL.021.b_4, na.rm = T)/n,
             e.other = sum (RL.021.b_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 what equipment school provided, no sig. group dif. n = 296")+
  facet_wrap (~conditions, nrow = 5)
```

### 2.1.2.2 By poverty level

  * What equipment children have access to - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.b_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.b_2, na.rm = T)/n,
             c.laptop = sum (RL.021.b_3, na.rm = T)/n,
             d.desktop = sum (RL.021.b_4, na.rm = T)/n,
             e.other = sum (RL.021.b_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 what equipment used, n = 414")
```

  * Who provided the equipment & What equipment school provided - no sig. group difference \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (c.school = ifelse ((RL.022.b == 1 | RL.023.b == 1 | RL.024.b == 1 | RL.025.b== 1 | RL.026.b == 1), 1, 0), 
          b.household = ifelse ((RL.022.b == 2 | RL.023.b == 2 | RL.024.b == 2 | RL.025.b == 2 | RL.026.b == 2), 1, 0), 
          a.other = ifelse ((RL.022.b == 3 | RL.023.b == 3 | RL.024.b == 3 | RL.025.b== 3 | RL.026.b == 3), 1, 0))%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             c.school = sum (c.school,na.rm = T)/n,
             b.household = sum (b.household, na.rm = T)/n,
             a.other = sum (a.other, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("c.school", "b.household", "a.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 who provided equipment, n = 414")


rl_K12 <- rl %>%
  mutate (school = ifelse ((RL.022.b == 1 | RL.023.b == 1 | RL.024.b == 1 | RL.025.b== 1 | RL.026.b == 1), 1, 0), 
          household = ifelse ((RL.022.b == 2 | RL.023.b == 2 | RL.024.b == 2 | RL.025.b == 2 | RL.026.b == 2), 1, 0), 
          other = ifelse ((RL.022.b == 3 | RL.023.b == 3 | RL.024.b == 3 | RL.025.b== 3 | RL.026.b == 3), 1, 0))%>%
  filter (RL.001.b == 1 & school == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.tablet = sum (RL.021.b_1,na.rm = T)/n,
             b.smart_phone = sum (RL.021.b_2, na.rm = T)/n,
             c.laptop = sum (RL.021.b_3, na.rm = T)/n,
             d.desktop = sum (RL.021.b_4, na.rm = T)/n,
             e.other = sum (RL.021.b_5, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.tablet", "b.smart_phone", "c.laptop", "d.desktop", "e.other"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 what equipment school provided, n = 296")
```

## 2.2 Internet

  * INTERNET.001.a/b How often is the internet available to pre-school/pre-K/K-12 children for educational purposes?\
    + Options: Always/Usually/Sometimes/Rarely/Never\
  * How often are/do your children in pre-school/pre-K/K-12:\
    + RL.018.a/b Unable to complete homework due to a lack of a reliable comuter or internet connection\
    + RL.019.a/b Use public wifi to do homework because of no/insufficient home internet connection\
    + RL.020.a/b Use public wifi to attend their remote learning sessions becuase of no/insufficient home internet connection\
    + Options: Always/Usually/Sometimes/Rarely/Never\

### 2.2.1 Pre-school/pre-K

  * Internet access\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (a.never_rarely_available = ifelse (INTERNET.001.a == 1 | INTERNET.001.a == 2, 1, 0),
          b.sometimes_available = ifelse (INTERNET.001.a == 3, 1, 0),
          c.usually_always_available = ifelse (INTERNET.001.a == 4 | INTERNET.001.a == 5, 1, 0)
          )%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             a.never_rarely_available = sum (a.never_rarely_available,na.rm = T)/n,
             b.sometimes_available = sum (b.sometimes_available, na.rm = T)/n,
             c.usually_always_available = sum (c.usually_always_available, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.never_rarely_available", "b.sometimes_available", "c.usually_always_available"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (x = conditions, y = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K Internet access, n = 220")
```

  * Equipment/Internet being challenge to children's learning\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (a.unable_to_do_homework = ifelse (RL.018.a %in% c(3,4,5), 1, 0),
          b.public_wifi_homework = ifelse (RL.019.a %in% c(3,4,5), 1, 0),
          c.public_wifi_remote_sessions = ifelse (RL.020.a %in% c(3,4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             a.unable_to_do_homework = sum (a.unable_to_do_homework,na.rm = T)/n,
             b.public_wifi_homework = sum (b.public_wifi_homework, na.rm = T)/n,
             c.public_wifi_remote_sessions = sum (c.public_wifi_remote_sessions, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.unable_to_do_homework", "b.public_wifi_homework", "c.public_wifi_remote_sessions"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K Internet challenges, n = 220")
```

### 2.2.1.1 By race/ethnicity

  * Internet access - no group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (a.never_rarely_available = ifelse (INTERNET.001.a == 1 | INTERNET.001.a == 2, 1, 0),
          b.sometimes_available = ifelse (INTERNET.001.a == 3, 1, 0),
          c.usually_always_available = ifelse (INTERNET.001.a == 4 | INTERNET.001.a == 5, 1, 0)
          )%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.never_rarely_available = sum (a.never_rarely_available,na.rm = T)/n,
             b.sometimes_available = sum (b.sometimes_available, na.rm = T)/n,
             c.usually_always_available = sum (c.usually_always_available, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.never_rarely_available", "b.sometimes_available", "c.usually_always_available"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (x = race_ethnic, y = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K Internet access, n = 220")+
  facet_wrap (~conditions, ncol = 3)
```

  * Equipment/Internet being challenge to children's learning - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (a.unable_to_do_homework = ifelse (RL.018.a %in% c(3,4,5), 1, 0),
          b.public_wifi_homework = ifelse (RL.019.a %in% c(3,4,5), 1, 0),
          c.public_wifi_remote_sessions = ifelse (RL.020.a %in% c(3,4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
    filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.unable_to_do_homework = sum (a.unable_to_do_homework,na.rm = T)/n,
             b.public_wifi_homework = sum (b.public_wifi_homework, na.rm = T)/n,
             c.public_wifi_remote_sessions = sum (c.public_wifi_remote_sessions, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.unable_to_do_homework", "b.public_wifi_homework", "c.public_wifi_remote_sessions"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K Internet challenges, n = 220")+
  facet_wrap (~conditions, nrow = 3)
```

### 2.2.1.2 By poverty level

  * Internet access - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (a.never_rarely_available = ifelse (INTERNET.001.a == 1 | INTERNET.001.a == 2, 1, 0),
          b.sometimes_available = ifelse (INTERNET.001.a == 3, 1, 0),
          c.usually_always_available = ifelse (INTERNET.001.a == 4 | INTERNET.001.a == 5, 1, 0)
          )%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.never_rarely_available = sum (a.never_rarely_available,na.rm = T)/n,
             b.sometimes_available = sum (b.sometimes_available, na.rm = T)/n,
             c.usually_always_available = sum (c.usually_always_available, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.never_rarely_available", "b.sometimes_available", "c.usually_always_available"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (x = conditions, y = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K Internet access, n = 220")
```

  * Equipment/Internet being challenge to children's learning\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (a.unable_to_do_homework = ifelse (RL.018.a %in% c(3,4,5), 1, 0),
          b.public_wifi_homework = ifelse (RL.019.a %in% c(3,4,5), 1, 0),
          c.public_wifi_remote_sessions = ifelse (RL.020.a %in% c(3,4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
    filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.unable_to_do_homework = sum (a.unable_to_do_homework,na.rm = T)/n,
             b.public_wifi_homework = sum (b.public_wifi_homework, na.rm = T)/n,
             c.public_wifi_remote_sessions = sum (c.public_wifi_remote_sessions, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.unable_to_do_homework", "b.public_wifi_homework", "c.public_wifi_remote_sessions"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K Internet challenges, n = 220")
```

### 2.2.2 K-12

  * Internet access
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (a.never_rarely_available = ifelse (INTERNET.001.b == 1 | INTERNET.001.b == 2, 1, 0),
          b.sometimes_available = ifelse (INTERNET.001.b == 3, 1, 0),
          c.usually_always_available = ifelse (INTERNET.001.b == 4 | INTERNET.001.b == 5, 1, 0)
          )%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             a.never_rarely_available = sum (a.never_rarely_available,na.rm = T)/n,
             b.sometimes_available = sum (b.sometimes_available, na.rm = T)/n,
             c.usually_always_available = sum (c.usually_always_available, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.never_rarely_available", "b.sometimes_available", "c.usually_always_available"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (x = conditions, y = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 Internet access, n = 414")
```

  * Equipment/Internet being challenge to children's learning
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (a.unable_to_do_homework = ifelse (RL.018.b %in% c(3,4,5), 1, 0),
          b.public_wifi_homework = ifelse (RL.019.b %in% c(3,4,5), 1, 0),
          c.public_wifi_remote_sessions = ifelse (RL.020.b %in% c(3,4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             a.unable_to_do_homework = sum (a.unable_to_do_homework,na.rm = T)/n,
             b.public_wifi_homework = sum (b.public_wifi_homework, na.rm = T)/n,
             c.public_wifi_remote_sessions = sum (c.public_wifi_remote_sessions, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.unable_to_do_homework", "b.public_wifi_homework", "c.public_wifi_remote_sessions"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 Internet challenges, n = 414")
```

#### 2.2.2.1 By race/ethnicity

  * Internet access - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (a.never_rarely_available = ifelse (INTERNET.001.b == 1 | INTERNET.001.b == 2, 1, 0),
          b.sometimes_available = ifelse (INTERNET.001.b == 3, 1, 0),
          c.usually_always_available = ifelse (INTERNET.001.b == 4 | INTERNET.001.b == 5, 1, 0)
          )%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.never_rarely_available = sum (a.never_rarely_available,na.rm = T)/n,
             b.sometimes_available = sum (b.sometimes_available, na.rm = T)/n,
             c.usually_always_available = sum (c.usually_always_available, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.never_rarely_available", "b.sometimes_available", "c.usually_always_available"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (x = race_ethnic, y = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 Internet access, n = 414")+
  facet_wrap (~conditions, ncol = 3)
```

  * Equipment/Internet being challenge to children's learning \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (a.unable_to_do_homework = ifelse (RL.018.b %in% c(3,4,5), 1, 0),
          b.public_wifi_homework = ifelse (RL.019.b %in% c(3,4,5), 1, 0),
          c.public_wifi_remote_sessions = ifelse (RL.020.b %in% c(3,4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.unable_to_do_homework = sum (a.unable_to_do_homework,na.rm = T)/n,
             b.public_wifi_homework = sum (b.public_wifi_homework, na.rm = T)/n,
             c.public_wifi_remote_sessions = sum (c.public_wifi_remote_sessions, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.unable_to_do_homework", "b.public_wifi_homework", "c.public_wifi_remote_sessions"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 Internet challenges, n = 414")+
  facet_wrap (~conditions, nrow = 3)
```

#### 2.2.2.2 By poverty level

  * Internet access - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (a.never_rarely_available = ifelse (INTERNET.001.b == 1 | INTERNET.001.b == 2, 1, 0),
          b.sometimes_available = ifelse (INTERNET.001.b == 3, 1, 0),
          c.usually_always_available = ifelse (INTERNET.001.b == 4 | INTERNET.001.b == 5, 1, 0)
          )%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.never_rarely_available = sum (a.never_rarely_available,na.rm = T)/n,
             b.sometimes_available = sum (b.sometimes_available, na.rm = T)/n,
             c.usually_always_available = sum (c.usually_always_available, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.never_rarely_available", "b.sometimes_available", "c.usually_always_available"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (x = conditions, y = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 Internet access, n = 414")
```

  * Equipment/Internet being challenge to children's learning\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (a.unable_to_do_homework = ifelse (RL.018.b %in% c(3,4,5), 1, 0),
          b.public_wifi_homework = ifelse (RL.019.b %in% c(3,4,5), 1, 0),
          c.public_wifi_remote_sessions = ifelse (RL.020.b %in% c(3,4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.unable_to_do_homework = sum (a.unable_to_do_homework,na.rm = T)/n,
             b.public_wifi_homework = sum (b.public_wifi_homework, na.rm = T)/n,
             c.public_wifi_remote_sessions = sum (c.public_wifi_remote_sessions, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.unable_to_do_homework", "b.public_wifi_homework", "c.public_wifi_remote_sessions"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 Internet challenges, n = 414")
```

# 3. Experiences with Remote Learning

## 3.1 Activities using remote learning for

  * RL.002.a/b What kind of virtual learning activities does your children in pre-k-/K-12 use? Select all that apply\
    + Individual Calls with children/families\
    + Sending schedules and resources\
    + Large group video meetings\
    + Recording videos\
    + Sending materials to families\
    + Small group video meetings\
    + Others, specify\
    + None of the above\

### 3.1.1 Pre-school/Pre-K

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             individual_call = sum(RL.002.a_1, na.rm = T)/n,
             sending_schedules = sum(RL.002.a_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002.a_3, na.rm = T)/n,
             recording_videos = sum(RL.002.a_4, na.rm = T)/n,
             sending_materials = sum(RL.002.a_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002.a_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K in remote learning, n = 220")

```

### 3.1.1.1 By race/ethnicity - no group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             individual_call = sum(RL.002.a_1, na.rm = T)/n,
             sending_schedules = sum(RL.002.a_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002.a_3, na.rm = T)/n,
             recording_videos = sum(RL.002.a_4, na.rm = T)/n,
             sending_materials = sum(RL.002.a_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002.a_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -0.5, color = "black", size =2, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K in remote learning, n = 220")+
  facet_wrap (~types, nrow = 3)

```

### 3.1.1.2 By poverty level - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             individual_call = sum(RL.002.a_1, na.rm = T)/n,
             sending_schedules = sum(RL.002.a_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002.a_3, na.rm = T)/n,
             recording_videos = sum(RL.002.a_4, na.rm = T)/n,
             sending_materials = sum(RL.002.a_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002.a_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K in remote learning, n = 220")

```

### 3.1.2 K-12

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             individual_call = sum(Rl.002.b_1, na.rm = T)/n,
             sending_schedules = sum(RL.002.b_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002.b_3, na.rm = T)/n,
             recording_videos = sum(RL.002.b_4, na.rm = T)/n,
             sending_materials = sum(RL.002.b_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002.b_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 in remote learning, n = 414")

```

#### 3.1.2.1 By race/ethnicity 

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             individual_call = sum(Rl.002.b_1, na.rm = T)/n,
             sending_schedules = sum(RL.002.b_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002.b_3, na.rm = T)/n,
             recording_videos = sum(RL.002.b_4, na.rm = T)/n,
             sending_materials = sum(RL.002.b_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002.b_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                   position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 in remote learning, n = 414")+
  facet_wrap (~types, nrow = 3)

```

#### 3.1.2.1 By poverty level - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
##Note this section cannot run because of data problems. There were no RL.002.b_1-6 variables in the dataset. 
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             individual_call = sum(Rl.002.b_1, na.rm = T)/n,
             sending_schedules = sum(RL.002.b_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002.b_3, na.rm = T)/n,
             recording_videos = sum(RL.002.b_4, na.rm = T)/n,
             sending_materials = sum(RL.002.b_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002.b_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 in remote learning, n = 414")

```

## 3.2 Time spent in remote learning by session and by day
  
  * RL.007.a/b How much total time per day are your pre-school/pre-K/K-12 chidren on a virtual learning platform?\
    + For pre-school/pre-k: -Less than 30 minutes/31-60 minutes/61-120 minutes/121-180 minutes/more than 180 minutes\
    + For K-12: -Less than 1 hour/1-2 hours/2-4 hours/4-8 hours/More than 8 hours\
  * RL.008.a/b How much time does an individual remote learning session last for your pre-school/pre-k/K-12 children?\ 
    + Less than 30 minutes\
    + 31-60 minutes\
    + 61-120 minutes\
    + 121-180 minutes\
    + More than 180 minutes\

### 3.2.1 Pre-school/pre-K

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_hours <- rl %>%
  filter (RL.001.a == 1)%>%
  mutate (hour_pd_15 = ifelse (RL.007.a == 1, 1, 0), 
          hour_pd_45 = ifelse (RL.007.a == 2, 1, 0), 
          hour_pd_90 = ifelse (RL.007.a == 3, 1, 0), 
          hour_pd_150 = ifelse (RL.007.a == 4, 1, 0), 
          hour_pd_180 = ifelse (RL.007.a == 5, 1, 0), 
          hour_sc_15 = ifelse (RL.008.a == 1, 1, 0), 
          hour_sc_45 = ifelse (RL.008.a == 2, 1, 0), 
          hour_sc_90 = ifelse (RL.008.a == 3, 1, 0), 
          hour_sc_150 = ifelse (RL.008.a == 4, 1, 0), 
          hour_sc_180 = ifelse (RL.008.a == 5, 1, 0))

rl_hours_pd <- rl_hours %>%
  summarise (n = n(),
             a.pd_below_30 = sum(hour_pd_15, na.rm = T)/n, 
             b.pd_31_60 = sum(hour_pd_45, na.rm = T)/n, 
             c.pd_61_120 = sum(hour_pd_90, na.rm = T)/n, 
             d.pd_121_180 = sum(hour_pd_150, na.rm = T)/n, 
             e.pd_above_180 = sum(hour_pd_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.pd_below_30", "b.pd_31_60", "c.pd_61_120", "d.pd_121_180", "e.pd_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_hours_sc <- rl_hours %>%
  summarise (n = n(),
             a.sc_below_30 = sum(hour_sc_15, na.rm = T)/n, 
             b.sc_31_60 = sum(hour_sc_45, na.rm = T)/n, 
             c.sc_61_120 = sum(hour_sc_90, na.rm = T)/n, 
             d.sc_121_180 = sum(hour_sc_150, na.rm = T)/n, 
             e.sc_above_180 = sum(hour_sc_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.sc_below_30", "b.sc_31_60", "c.sc_61_120", "d.sc_121_180", "e.sc_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_hours_pd %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = hours)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Day  - pre-school/pre-K")

rl_hours_sc %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = hours)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Individual Session - pre-school/pre-K")

```

### 3.2.1.1 By race/ethnicity 

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_hours_pd <- rl_hours %>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.pd_below_30 = sum(hour_pd_15, na.rm = T)/n, 
             b.pd_31_60 = sum(hour_pd_45, na.rm = T)/n, 
             c.pd_61_120 = sum(hour_pd_90, na.rm = T)/n, 
             d.pd_121_180 = sum(hour_pd_150, na.rm = T)/n, 
             e.pd_above_180 = sum(hour_pd_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.pd_below_30", "b.pd_31_60", "c.pd_61_120", "d.pd_121_180", "e.pd_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_hours_sc <- rl_hours %>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.sc_below_30 = sum(hour_sc_15, na.rm = T)/n, 
             b.sc_31_60 = sum(hour_sc_45, na.rm = T)/n, 
             c.sc_61_120 = sum(hour_sc_90, na.rm = T)/n, 
             d.sc_121_180 = sum(hour_sc_150, na.rm = T)/n, 
             e.sc_above_180 = sum(hour_sc_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.sc_below_30", "b.sc_31_60", "c.sc_61_120", "d.sc_121_180", "e.sc_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_hours_pd %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -0.5, color = "black", size =2, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Day  - pre-school/pre-K")+
  facet_wrap (~hours, nrow = 5)

rl_hours_sc %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -0.5, color = "black", size =2, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Individual Session - pre-school/pre-K")+
  facet_wrap (~hours, nrow = 5)

```

### 3.2.1.2 By poverty level - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_hours_pd <- rl_hours %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.pd_below_30 = sum(hour_pd_15, na.rm = T)/n, 
             b.pd_31_60 = sum(hour_pd_45, na.rm = T)/n, 
             c.pd_61_120 = sum(hour_pd_90, na.rm = T)/n, 
             d.pd_121_180 = sum(hour_pd_150, na.rm = T)/n, 
             e.pd_above_180 = sum(hour_pd_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.pd_below_30", "b.pd_31_60", "c.pd_61_120", "d.pd_121_180", "e.pd_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_hours_sc <- rl_hours %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.sc_below_30 = sum(hour_sc_15, na.rm = T)/n, 
             b.sc_31_60 = sum(hour_sc_45, na.rm = T)/n, 
             c.sc_61_120 = sum(hour_sc_90, na.rm = T)/n, 
             d.sc_121_180 = sum(hour_sc_150, na.rm = T)/n, 
             e.sc_above_180 = sum(hour_sc_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.sc_below_30", "b.sc_31_60", "c.sc_61_120", "d.sc_121_180", "e.sc_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_hours_pd %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Day  - pre-school/pre-K")

rl_hours_sc %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Individual Session - pre-school/pre-K")

```

### 3.2.2 K-12

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_hours <- rl %>%
  filter (RL.001.b == 1)%>%
  mutate (hour_pd_15 = ifelse (RL.007.b == 1, 1, 0), 
          hour_pd_45 = ifelse (RL.007.b == 2, 1, 0), 
          hour_pd_90 = ifelse (RL.007.b == 3, 1, 0), 
          hour_pd_150 = ifelse (RL.007.b == 4, 1, 0), 
          hour_pd_180 = ifelse (RL.007.b == 5, 1, 0), 
          hour_sc_15 = ifelse (RL.008.b == 1, 1, 0), 
          hour_sc_45 = ifelse (RL.008.b == 2, 1, 0), 
          hour_sc_90 = ifelse (RL.008.b == 3, 1, 0), 
          hour_sc_150 = ifelse (RL.008.b == 4, 1, 0), 
          hour_sc_180 = ifelse (RL.008.b == 5, 1, 0))

rl_hours_pd <- rl_hours %>%
  summarise (n = n(),
             a.pd_below_1h = sum(hour_pd_15, na.rm = T)/n, 
             b.pd_1_2h = sum(hour_pd_45, na.rm = T)/n, 
             c.pd_2_4h = sum(hour_pd_90, na.rm = T)/n, 
             d.pd_4_8h = sum(hour_pd_150, na.rm = T)/n, 
             e.pd_above_8h = sum(hour_pd_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.pd_below_1h", "b.pd_1_2h", "c.pd_2_4h", "d.pd_4_8h", "e.pd_above_8h"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_hours_sc <- rl_hours %>%
  summarise (n = n(),
             a.sc_below_30 = sum(hour_sc_15, na.rm = T)/n, 
             b.sc_31_60 = sum(hour_sc_45, na.rm = T)/n, 
             c.sc_61_120 = sum(hour_sc_90, na.rm = T)/n, 
             d.sc_121_180 = sum(hour_sc_150, na.rm = T)/n, 
             e.sc_above_180 = sum(hour_sc_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.sc_below_30", "b.sc_31_60", "c.sc_61_120", "d.sc_121_180", "e.sc_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_hours_pd %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = hours)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Day - K-12")

rl_hours_sc %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = hours)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Individual Session - K-12")

```

#### 3.2.2.1 By race/ethnicity

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_hours_pd <- rl_hours %>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.pd_below_1h = sum(hour_pd_15, na.rm = T)/n, 
             b.pd_1_2h = sum(hour_pd_45, na.rm = T)/n, 
             c.pd_2_4h = sum(hour_pd_90, na.rm = T)/n, 
             d.pd_4_8h = sum(hour_pd_150, na.rm = T)/n, 
             e.pd_above_8h = sum(hour_pd_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.pd_below_1h", "b.pd_1_2h", "c.pd_2_4h", "d.pd_4_8h", "e.pd_above_8h"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_hours_sc <- rl_hours %>%
    filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.sc_below_30 = sum(hour_sc_15, na.rm = T)/n, 
             b.sc_31_60 = sum(hour_sc_45, na.rm = T)/n, 
             c.sc_61_120 = sum(hour_sc_90, na.rm = T)/n, 
             d.sc_121_180 = sum(hour_sc_150, na.rm = T)/n, 
             e.sc_above_180 = sum(hour_sc_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.sc_below_30", "b.sc_31_60", "c.sc_61_120", "d.sc_121_180", "e.sc_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_hours_pd %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Day - K-12")+
  facet_wrap(~hours, nrow = 5)

rl_hours_sc %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Individual Session - K-12")+
  facet_wrap(~hours, nrow = 5)

```

#### 3.2.2.2 By poverty level

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_hours_pd <- rl_hours %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.pd_below_1h = sum(hour_pd_15, na.rm = T)/n, 
             b.pd_1_2h = sum(hour_pd_45, na.rm = T)/n, 
             c.pd_2_4h = sum(hour_pd_90, na.rm = T)/n, 
             d.pd_4_8h = sum(hour_pd_150, na.rm = T)/n, 
             e.pd_above_8h = sum(hour_pd_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.pd_below_1h", "b.pd_1_2h", "c.pd_2_4h", "d.pd_4_8h", "e.pd_above_8h"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_hours_sc <- rl_hours %>%
    filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.sc_below_30 = sum(hour_sc_15, na.rm = T)/n, 
             b.sc_31_60 = sum(hour_sc_45, na.rm = T)/n, 
             c.sc_61_120 = sum(hour_sc_90, na.rm = T)/n, 
             d.sc_121_180 = sum(hour_sc_150, na.rm = T)/n, 
             e.sc_above_180 = sum(hour_sc_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.sc_below_30", "b.sc_31_60", "c.sc_61_120", "d.sc_121_180", "e.sc_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_hours_pd %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Day - K-12")

rl_hours_sc %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Individual Session - K-12")

```
  
## 3.3 Challenges

 * RL.003.a/b What are the challenges of remote instruction with young children and families? Select all that apply:\
    - Engaging children through remote instruction\
    - Developing an engaging distance curriculum\
    - Access to computers and technology for children and families\
    - Access to computer and technology for staff\
    - Managing own children's remote instruction\
    - other\
    - None of the above\

### 3.3.1 Pre-school/Pre-K

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003.a_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003.a_2, na.rm = T)/n,
             access_tech_children = sum(RL.003.a_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003.a_4, na.rm = T)/n,
             managing_own_children = sum(RL.003.a_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K challenges, n = 220")

```  

#### 3.3.1.1 By race/ethnicity - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003.a_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003.a_2, na.rm = T)/n,
             access_tech_children = sum(RL.003.a_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003.a_4, na.rm = T)/n,
             managing_own_children = sum(RL.003.a_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K challenges, n = 220")+
  facet_wrap(~types, nrow = 5)

```  

#### 3.3.1.2 By poverty level - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003.a_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003.a_2, na.rm = T)/n,
             access_tech_children = sum(RL.003.a_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003.a_4, na.rm = T)/n,
             managing_own_children = sum(RL.003.a_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-K Challenges, n = 220")

```  

### 3.3.2 K-12

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003.b_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003.b_2, na.rm = T)/n,
             access_tech_children = sum(RL.003.b_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003.b_4, na.rm = T)/n,
             managing_own_children = sum(RL.003.b_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 challenges, n = 414")

```  
  
#### 3.3.2.1 By race/ethnicity 

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003.b_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003.b_2, na.rm = T)/n,
             access_tech_children = sum(RL.003.b_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003.b_4, na.rm = T)/n,
             managing_own_children = sum(RL.003.b_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 challenges, n = 414")+
  facet_wrap(~types, nrow = 5)

```  

#### 3.3.2.1 By poverty level 

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003.b_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003.b_2, na.rm = T)/n,
             access_tech_children = sum(RL.003.b_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003.b_4, na.rm = T)/n,
             managing_own_children = sum(RL.003.b_5, na.rm = T)/n)%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 challenges, n = 414")

```  

## 3.4 Supplements for remote learning

  * RL.027.a/b Do your pre-school/pre-k/k-12 children participate in any of the following as supplements to their remote learning? Select all that apply\
    + Remote tutoring\
    + In-person tutoring\
    + Learning pods or other small group led by an unpaid adult\
    + Learning pods or other small group by a paid adult\
    + Online learning app or platform\
    + A book subscription or reading club\
    + Remote extracurriculars\
    + In-person extracurriculars\
    + Other\
    + None of the above\
    
### 3.4.1 Pre-school/Pre-K
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             a.remote_tutoring = sum (RL.027.a_1,na.rm = T)/n,
             b.inperson_tutoring = sum (RL.027.a_2, na.rm = T)/n,
             c.unpaid_small_group = sum (RL.027.a_3, na.rm = T)/n,
             d.paid_small_group = sum (RL.027.a_4, na.rm = T)/n,
             e.online_app_platform = sum (RL.027.a_5, na.rm = T)/n,
             f.book_reading = sum (RL.027.a_6,na.rm = T)/n,
             g.remote_extracurriculars = sum (RL.027.a_7, na.rm = T)/n,
             h.inperson_extracurriculars = sum (RL.027.a_8, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.remote_tutoring", "b.inperson_tutoring", "c.unpaid_small_group", "d.paid_small_group", "e.online_app_platform", "f.book_reading", "g.remote_extracurriculars", "h.inperson_extracurriculars"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K supplements, n = 220")
```    

#### 3.4.1.1 By race/ethnicity
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.remote_tutoring = sum (RL.027.a_1,na.rm = T)/n,
             b.inperson_tutoring = sum (RL.027.a_2, na.rm = T)/n,
             c.unpaid_small_group = sum (RL.027.a_3, na.rm = T)/n,
             d.paid_small_group = sum (RL.027.a_4, na.rm = T)/n,
             e.online_app_platform = sum (RL.027.a_5, na.rm = T)/n,
             f.book_reading = sum (RL.027.a_6,na.rm = T)/n,
             g.remote_extracurriculars = sum (RL.027.a_7, na.rm = T)/n,
             h.inperson_extracurriculars = sum (RL.027.a_8, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.remote_tutoring", "b.inperson_tutoring", "c.unpaid_small_group", "d.paid_small_group", "e.online_app_platform", "f.book_reading", "g.remote_extracurriculars", "h.inperson_extracurriculars"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K supplements, n = 220")+
  facet_wrap(~conditions, nrow = 4)
```    

#### 3.4.1.2 By poverty level
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.remote_tutoring = sum (RL.027.a_1,na.rm = T)/n,
             b.inperson_tutoring = sum (RL.027.a_2, na.rm = T)/n,
             c.unpaid_small_group = sum (RL.027.a_3, na.rm = T)/n,
             d.paid_small_group = sum (RL.027.a_4, na.rm = T)/n,
             e.online_app_platform = sum (RL.027.a_5, na.rm = T)/n,
             f.book_reading = sum (RL.027.a_6,na.rm = T)/n,
             g.remote_extracurriculars = sum (RL.027.a_7, na.rm = T)/n,
             h.inperson_extracurriculars = sum (RL.027.a_8, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.remote_tutoring", "b.inperson_tutoring", "c.unpaid_small_group", "d.paid_small_group", "e.online_app_platform", "f.book_reading", "g.remote_extracurriculars", "h.inperson_extracurriculars"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_prek %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K supplements, n = 220")
```    
    
### 3.4.2 K-12
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             a.remote_tutoring = sum (RL.027.b_1,na.rm = T)/n,
             b.inperson_tutoring = sum (RL.027.b_2, na.rm = T)/n,
             c.unpaid_small_group = sum (RL.027.b_3, na.rm = T)/n,
             d.paid_small_group = sum (RL.027.b_4, na.rm = T)/n,
             e.online_app_platform = sum (RL.027.b_5, na.rm = T)/n,
             f.book_reading = sum (RL.027.b_6,na.rm = T)/n,
             g.remote_extracurriculars = sum (RL.027.b_7, na.rm = T)/n,
             h.inperson_extracurriculars = sum (RL.027.b_8, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.remote_tutoring", "b.inperson_tutoring", "c.unpaid_small_group", "d.paid_small_group", "e.online_app_platform", "f.book_reading", "g.remote_extracurriculars", "h.inperson_extracurriculars"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = conditions )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 in supplements, n = 414")
```    

#### 3.4.2.1 By race/ethnicity
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.remote_tutoring = sum (RL.027.b_1,na.rm = T)/n,
             b.inperson_tutoring = sum (RL.027.b_2, na.rm = T)/n,
             c.unpaid_small_group = sum (RL.027.b_3, na.rm = T)/n,
             d.paid_small_group = sum (RL.027.b_4, na.rm = T)/n,
             e.online_app_platform = sum (RL.027.b_5, na.rm = T)/n,
             f.book_reading = sum (RL.027.b_6,na.rm = T)/n,
             g.remote_extracurriculars = sum (RL.027.b_7, na.rm = T)/n,
             h.inperson_extracurriculars = sum (RL.027.b_8, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.remote_tutoring", "b.inperson_tutoring", "c.unpaid_small_group", "d.paid_small_group", "e.online_app_platform", "f.book_reading", "g.remote_extracurriculars", "h.inperson_extracurriculars"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 supplements, n = 414")+
  facet_wrap(~conditions, nrow = 4)
```    

#### 3.4.2.2 By poverty level
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.remote_tutoring = sum (RL.027.b_1,na.rm = T)/n,
             b.inperson_tutoring = sum (RL.027.b_2, na.rm = T)/n,
             c.unpaid_small_group = sum (RL.027.b_3, na.rm = T)/n,
             d.paid_small_group = sum (RL.027.b_4, na.rm = T)/n,
             e.online_app_platform = sum (RL.027.b_5, na.rm = T)/n,
             f.book_reading = sum (RL.027.b_6,na.rm = T)/n,
             g.remote_extracurriculars = sum (RL.027.b_7, na.rm = T)/n,
             h.inperson_extracurriculars = sum (RL.027.b_8, na.rm = T)/n
      )%>%
  pivot_longer (cols = c("a.remote_tutoring", "b.inperson_tutoring", "c.unpaid_small_group", "d.paid_small_group", "e.online_app_platform", "f.book_reading", "g.remote_extracurriculars", "h.inperson_extracurriculars"), names_to = "conditions", values_to = "prop")%>%
  mutate (count = prop * n, 
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop-moe,
          ci_high = prop+moe)

rl_K12 %>%
  ggplot(mapping = aes (y = conditions, x = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = 0, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 supplements, n = 414")
```

# 4. Influence/Perception of Remote Learining

## 4.1 Amount of schoolwork & Caregiver help with schoolwork

  * RL.028.a/b Compared to before the pandemic, how has the amount of schoolwork that your pre-school/pre-k/k-12 children needs to complete outside of class time changed with remote learning? # Not find this variable in the dataset \
    + Less homework\
    + Same amount of homework\
    + More homework\
  * (If select less/more) RL.029.a/b how did these changes affect the time your spent helping your pre-school/pre-K/K-12 children's school work? # Not find this variable in the dataset\
    + I spent less time helping my children's schoolwork\
    + Same amount of time\
    + I spent more time helping my children's schoolwork\
    
### 4.1.1 Pre-school/Pre-K

  * Amount of work\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (less_homework = ifelse (RL.028.a == 1, 1, 0),
          same_homework = ifelse (RL.028.a == 2, 1, 0),
          more_homework = ifelse (RL.028.a == 3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             less_homework = sum(less_homework, na.rm = T)/n,
             same_homework = sum(same_homework, na.rm = T)/n,
             more_homework = sum(more_homework, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_homework", "same_homework", "more_homework"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K amount of schoolwork, n = 220")

```

  * Caregiver help with schoolwork\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_prek <- rl %>%
  mutate (less_homework = ifelse (RL.028.a == 1, 1, 0),
          same_homework = ifelse (RL.028.a == 2, 1, 0),
          more_homework = ifelse (RL.028.a == 3, 1, 0), 
          less_time_help = ifelse (RL.029.a == 1, 1, 0),
          same_time_help = ifelse (RL.029.a == 2, 1, 0),
          more_time_help = ifelse (RL.029.a == 3, 1, 0), )%>%
  filter (RL.001.a == 1 & (less_homework == 1 | more_homework == 1))%>%
  summarise (n = n(),
             less_time_help = sum(less_time_help, na.rm = T)/n,
             same_time_help = sum(same_time_help, na.rm = T)/n,
             more_time_help = sum(more_time_help, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_time_help", "same_time_help", "more_time_help"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K caregiver help with schoolwork, n = 136")

```

#### 4.1.1.1 By race/ethnicity

  * Amount of work - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (less_homework = ifelse (RL.028.a == 1, 1, 0),
          same_homework = ifelse (RL.028.a == 2, 1, 0),
          more_homework = ifelse (RL.028.a == 3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             less_homework = sum(less_homework, na.rm = T)/n,
             same_homework = sum(same_homework, na.rm = T)/n,
             more_homework = sum(more_homework, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_homework", "same_homework", "more_homework"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K amount of work, n = 220")+
  facet_wrap (~types, nrow = 3)

```

  * Caregiver help with schoolwork - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_prek <- rl %>%
  mutate (less_homework = ifelse (RL.028.a == 1, 1, 0),
          same_homework = ifelse (RL.028.a == 2, 1, 0),
          more_homework = ifelse (RL.028.a == 3, 1, 0), 
          less_time_help = ifelse (RL.029.a == 1, 1, 0),
          same_time_help = ifelse (RL.029.a == 2, 1, 0),
          more_time_help = ifelse (RL.029.a == 3, 1, 0), )%>%
  filter (RL.001.a == 1 & (less_homework == 1 | more_homework == 1))%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             less_time_help = sum(less_time_help, na.rm = T)/n,
             same_time_help = sum(same_time_help, na.rm = T)/n,
             more_time_help = sum(more_time_help, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_time_help", "same_time_help", "more_time_help"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K caregiver help with schoolwork, n = 136")+
  facet_wrap (~types, nrow = 3)

```

#### 4.1.1.2 By poverty level

  * Amount of work - no group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (less_homework = ifelse (RL.028.a == 1, 1, 0),
          same_homework = ifelse (RL.028.a == 2, 1, 0),
          more_homework = ifelse (RL.028.a == 3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             less_homework = sum(less_homework, na.rm = T)/n,
             same_homework = sum(same_homework, na.rm = T)/n,
             more_homework = sum(more_homework, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_homework", "same_homework", "more_homework"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K amount of work, n = 220")

```

  * Caregiver help with schoolwork - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_prek <- rl %>%
  mutate (less_homework = ifelse (RL.028.a == 1, 1, 0),
          same_homework = ifelse (RL.028.a == 2, 1, 0),
          more_homework = ifelse (RL.028.a == 3, 1, 0), 
          less_time_help = ifelse (RL.029.a == 1, 1, 0),
          same_time_help = ifelse (RL.029.a == 2, 1, 0),
          more_time_help = ifelse (RL.029.a == 3, 1, 0), )%>%
  filter (RL.001.a == 1 & (less_homework == 1 | more_homework == 1))%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             less_time_help = sum(less_time_help, na.rm = T)/n,
             same_time_help = sum(same_time_help, na.rm = T)/n,
             more_time_help = sum(more_time_help, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_time_help", "same_time_help", "more_time_help"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K caregiver help with schoolwork, n = 136")

```

### 4.1.2 K-12

  * Amount of schoolwork\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (less_homework = ifelse (RL.028.b == 1, 1, 0),
          same_homework = ifelse (RL.028.b == 2, 1, 0),
          more_homework = ifelse (RL.028.b == 3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             less_homework = sum(less_homework, na.rm = T)/n,
             same_homework = sum(same_homework, na.rm = T)/n,
             more_homework = sum(more_homework, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_homework", "same_homework", "more_homework"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 amount of work, n = 414")

```

  * Caregiver help with schoolwork\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_K12 <- rl %>%
  mutate (less_homework = ifelse (RL.028.b == 1, 1, 0),
          same_homework = ifelse (RL.028.b == 2, 1, 0),
          more_homework = ifelse (RL.028.b == 3, 1, 0), 
          less_time_help = ifelse (RL.029.b == 1, 1, 0),
          same_time_help = ifelse (RL.029.b == 2, 1, 0),
          more_time_help = ifelse (RL.029.b == 3, 1, 0), )%>%
  filter (RL.001.b == 1 & (less_homework == 1 | more_homework == 1))%>%
  summarise (n = n(),
             less_time_help = sum(less_time_help, na.rm = T)/n,
             same_time_help = sum(same_time_help, na.rm = T)/n,
             more_time_help = sum(more_time_help, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_time_help", "same_time_help", "more_time_help"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 caregiver help with schoolwork, n = 266 ")

```

#### 4.1.2.1 By race/ethnicity

  * Amount of schoolwork - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (less_homework = ifelse (RL.028.b == 1, 1, 0),
          same_homework = ifelse (RL.028.b == 2, 1, 0),
          more_homework = ifelse (RL.028.b == 3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             less_homework = sum(less_homework, na.rm = T)/n,
             same_homework = sum(same_homework, na.rm = T)/n,
             more_homework = sum(more_homework, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_homework", "same_homework", "more_homework"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 amount of work, n = 414")+
  facet_wrap (~types, nrow = 3)

```

  * Caregiver help with schoolwork\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_K12 <- rl %>%
  mutate (less_homework = ifelse (RL.028.b == 1, 1, 0),
          same_homework = ifelse (RL.028.b == 2, 1, 0),
          more_homework = ifelse (RL.028.b == 3, 1, 0), 
          less_time_help = ifelse (RL.029.b == 1, 1, 0),
          same_time_help = ifelse (RL.029.b == 2, 1, 0),
          more_time_help = ifelse (RL.029.b == 3, 1, 0), )%>%
  filter (RL.001.b == 1 & (less_homework == 1 | more_homework == 1))%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             less_time_help = sum(less_time_help, na.rm = T)/n,
             same_time_help = sum(same_time_help, na.rm = T)/n,
             more_time_help = sum(more_time_help, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_time_help", "same_time_help", "more_time_help"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 caregiver help with schoolwork, n = 266 ")+
  facet_wrap (~types, nrow = 3)

```

#### 4.1.2.2 By poverty level

  * Amount of schoolwork - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (less_homework = ifelse (RL.028.b == 1, 1, 0),
          same_homework = ifelse (RL.028.b == 2, 1, 0),
          more_homework = ifelse (RL.028.b == 3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             less_homework = sum(less_homework, na.rm = T)/n,
             same_homework = sum(same_homework, na.rm = T)/n,
             more_homework = sum(more_homework, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_homework", "same_homework", "more_homework"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 amount of work, n = 414")

```

  * Caregiver help with schoolwork - no sig. group difference\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_K12 <- rl %>%
  mutate (less_homework = ifelse (RL.028.b == 1, 1, 0),
          same_homework = ifelse (RL.028.b == 2, 1, 0),
          more_homework = ifelse (RL.028.b == 3, 1, 0), 
          less_time_help = ifelse (RL.029.b == 1, 1, 0),
          same_time_help = ifelse (RL.029.b == 2, 1, 0),
          more_time_help = ifelse (RL.029.b == 3, 1, 0), )%>%
  filter (RL.001.b == 1 & (less_homework == 1 | more_homework == 1))%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             less_time_help = sum(less_time_help, na.rm = T)/n,
             same_time_help = sum(same_time_help, na.rm = T)/n,
             more_time_help = sum(more_time_help, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_time_help", "same_time_help", "more_time_help"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 caregivers help with schoolwork, n = 266 ")

```

## 4.2 Engagement, Motivation, Enjoy & Effectiveness

  * RL.030.a/b Compared to before the pandemic, how engaged is your pre-school/pre-K/K-12 children with the material that they are learining in school? - more/less engaged/no change\
  * RL.031.a/b Compared to before the pandemic, what is your pre-school/pre-k/k-12 children's level of motivation ab out seeing friends and classmates in school? - more/less motivated/no change\
  * RL.032.a/b Compared to in-person learning, how much do your Pre-school/Pre-K child(ren) enjoy school through remote learning?\
    + Enjoy remote learning less than in person\
    + No difference\
    + Enjoy remote learning more than in person\
  * RL.009.a/b To waht extent do you think screen time helps with your pre-school/pre-k/K-12 children's learning?\
    + Very effective\
    + Somewhat effective\
    + A mixture\
    + Somewhat ineffective\
    + Very ineffective\

### 4.2.1 Pre-school/Pre-K

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (less_engaged = ifelse (RL.030.a == 3, 1, 0),
          no_change = ifelse (RL.030.a == 2, 1, 0),
          more_engaged = ifelse (RL.030.a == 1, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             less_engaged = sum(less_engaged, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_engaged = sum(more_engaged, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_engaged", "no_change", "more_engaged"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K engagement, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (less_motivated = ifelse (RL.031.a == 3, 1, 0),
          no_change = ifelse (RL.031.a == 2, 1, 0),
          more_motivated= ifelse (RL.031.a == 1, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             less_motivated = sum(less_motivated, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_motivated = sum(more_motivated, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_motivated", "no_change", "more_motivated"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K motivation, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (enjoy_less = ifelse (RL.032.a == 1, 1, 0),
          no_change = ifelse (RL.032.a == 2, 1, 0),
          enjoy_more= ifelse (RL.032.a == 3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             enjoy_less = sum(enjoy_less, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             enjoy_more = sum(enjoy_more, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("enjoy_less", "no_change", "enjoy_more"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K enjoy, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (effective = ifelse (RL.009.a %in% c(1,2), 1, 0),
          mixture = ifelse (RL.009.a== 3, 1, 0),
          ineffective= ifelse (RL.009.a %in% c(4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             effective = sum(effective, na.rm = T)/n,
             mixture = sum(mixture, na.rm = T)/n,
             ineffective = sum(ineffective, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("effective", "mixture", "ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K effectiveness, n = 220")

```  

#### 4.2.1.1 By race/ethnicity - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (less_engaged = ifelse (RL.030.a == 3, 1, 0),
          no_change = ifelse (RL.030.a == 2, 1, 0),
          more_engaged = ifelse (RL.030.a == 1, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             less_engaged = sum(less_engaged, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_engaged = sum(more_engaged, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_engaged", "no_change", "more_engaged"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K engagement, n = 220")+
  facet_wrap(~types, nrow = 3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (less_motivated = ifelse (RL.031.a == 3, 1, 0),
          no_change = ifelse (RL.031.a == 2, 1, 0),
          more_motivated= ifelse (RL.031.a == 1, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             less_motivated = sum(less_motivated, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_motivated = sum(more_motivated, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_motivated", "no_change", "more_motivated"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K motivation, n = 220")+
  facet_wrap(~types, nrow = 3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (enjoy_less = ifelse (RL.032.a == 1, 1, 0),
          no_change = ifelse (RL.032.a == 2, 1, 0),
          enjoy_more= ifelse (RL.032.a == 3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             enjoy_less = sum(enjoy_less, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             enjoy_more = sum(enjoy_more, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("enjoy_less", "no_change", "enjoy_more"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K enjoy, n = 220")+
  facet_wrap(~types, nrow = 3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (effective = ifelse (RL.009.a %in% c(1,2), 1, 0),
          mixture = ifelse (RL.009.a== 3, 1, 0),
          ineffective= ifelse (RL.009.a %in% c(4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             effective = sum(effective, na.rm = T)/n,
             mixture = sum(mixture, na.rm = T)/n,
             ineffective = sum(ineffective, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("effective", "mixture", "ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K effectiveness, n = 220")+
  facet_wrap(~types, nrow = 3)

```  

#### 4.2.1.2 By poverty level - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (less_engaged = ifelse (RL.030.a == 3, 1, 0),
          no_change = ifelse (RL.030.a == 2, 1, 0),
          more_engaged = ifelse (RL.030.a == 1, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             less_engaged = sum(less_engaged, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_engaged = sum(more_engaged, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_engaged", "no_change", "more_engaged"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K engagement, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (less_motivated = ifelse (RL.031.a == 3, 1, 0),
          no_change = ifelse (RL.031.a == 2, 1, 0),
          more_motivated= ifelse (RL.031.a == 1, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             less_motivated = sum(less_motivated, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_motivated = sum(more_motivated, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_motivated", "no_change", "more_motivated"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K motivation, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (enjoy_less = ifelse (RL.032.a == 1, 1, 0),
          no_change = ifelse (RL.032.a == 2, 1, 0),
          enjoy_more= ifelse (RL.032.a == 3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             enjoy_less = sum(enjoy_less, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             enjoy_more = sum(enjoy_more, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("enjoy_less", "no_change", "enjoy_more"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K enjoy, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (effective = ifelse (RL.009.a %in% c(1,2), 1, 0),
          mixture = ifelse (RL.009.a== 3, 1, 0),
          ineffective= ifelse (RL.009.a %in% c(4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             effective = sum(effective, na.rm = T)/n,
             mixture = sum(mixture, na.rm = T)/n,
             ineffective = sum(ineffective, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("effective", "mixture", "ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K effectiveness, n = 220")

```  

### 4.2.2 K-12

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (less_engaged = ifelse (RL.030.b == 3, 1, 0),
          no_change = ifelse (RL.030.b == 2, 1, 0),
          more_engaged = ifelse (RL.030.b == 1, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             less_engaged = sum(less_engaged, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_engaged = sum(more_engaged, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_engaged", "no_change", "more_engaged"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 engagement, n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (less_motivated = ifelse (RL.031.b == 3, 1, 0),
          no_change = ifelse (RL.031.b == 2, 1, 0),
          more_motivated= ifelse (RL.031.b == 1, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             less_motivated = sum(less_motivated, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_motivated = sum(more_motivated, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_motivated", "no_change", "more_motivated"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 motivation, n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (enjoy_less = ifelse (RL.032.b == 1, 1, 0),
          no_change = ifelse (RL.032.b == 2, 1, 0),
          enjoy_more= ifelse (RL.032.b == 3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             enjoy_less = sum(enjoy_less, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             enjoy_more = sum(enjoy_more, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("enjoy_less", "no_change", "enjoy_more"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 enjoy, n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (effective = ifelse (RL.009.b %in% c(1,2), 1, 0),
          mixture = ifelse (RL.009.b== 3, 1, 0),
          ineffective= ifelse (RL.009.b %in% c(4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             effective = sum(effective, na.rm = T)/n,
             mixture = sum(mixture, na.rm = T)/n,
             ineffective = sum(ineffective, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("effective", "mixture", "ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 effectiveness, n = 414")

```  

#### 4.2.2.1 By race/ethnicity - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (less_engaged = ifelse (RL.030.b == 3, 1, 0),
          no_change = ifelse (RL.030.b == 2, 1, 0),
          more_engaged = ifelse (RL.030.b == 1, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             less_engaged = sum(less_engaged, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_engaged = sum(more_engaged, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_engaged", "no_change", "more_engaged"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 engagement, n = 414")+
  facet_wrap (~types, nrow = 3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (less_motivated = ifelse (RL.031.b == 3, 1, 0),
          no_change = ifelse (RL.031.b == 2, 1, 0),
          more_motivated= ifelse (RL.031.b == 1, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             less_motivated = sum(less_motivated, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_motivated = sum(more_motivated, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_motivated", "no_change", "more_motivated"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 motivation, n = 414")+
  facet_wrap (~types, nrow = 3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (enjoy_less = ifelse (RL.032.b == 1, 1, 0),
          no_change = ifelse (RL.032.b == 2, 1, 0),
          enjoy_more= ifelse (RL.032.b == 3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             enjoy_less = sum(enjoy_less, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             enjoy_more = sum(enjoy_more, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("enjoy_less", "no_change", "enjoy_more"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 enjoy, n = 414")+
  facet_wrap (~types, nrow = 3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (effective = ifelse (RL.009.b %in% c(1,2), 1, 0),
          mixture = ifelse (RL.009.b== 3, 1, 0),
          ineffective= ifelse (RL.009.b %in% c(4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             effective = sum(effective, na.rm = T)/n,
             mixture = sum(mixture, na.rm = T)/n,
             ineffective = sum(ineffective, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("effective", "mixture", "ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 effectiveness, n = 414")+
  facet_wrap (~types, nrow = 3)

```  

#### 4.2.2.2 By poverty level

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (less_engaged = ifelse (RL.030.b == 3, 1, 0),
          no_change = ifelse (RL.030.b == 2, 1, 0),
          more_engaged = ifelse (RL.030.b == 1, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             less_engaged = sum(less_engaged, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_engaged = sum(more_engaged, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_engaged", "no_change", "more_engaged"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 engagement, n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (less_motivated = ifelse (RL.031.b == 3, 1, 0),
          no_change = ifelse (RL.031.b == 2, 1, 0),
          more_motivated= ifelse (RL.031.b == 1, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             less_motivated = sum(less_motivated, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             more_motivated = sum(more_motivated, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("less_motivated", "no_change", "more_motivated"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 motivation - no sig. group dif, n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (enjoy_less = ifelse (RL.032.b == 1, 1, 0),
          no_change = ifelse (RL.032.b == 2, 1, 0),
          enjoy_more= ifelse (RL.032.b == 3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             enjoy_less = sum(enjoy_less, na.rm = T)/n,
             no_change = sum(no_change, na.rm = T)/n,
             enjoy_more = sum(enjoy_more, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("enjoy_less", "no_change", "enjoy_more"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 enjoy - no sig. group dif., n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (effective = ifelse (RL.009.b %in% c(1,2), 1, 0),
          mixture = ifelse (RL.009.b== 3, 1, 0),
          ineffective= ifelse (RL.009.b %in% c(4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             effective = sum(effective, na.rm = T)/n,
             mixture = sum(mixture, na.rm = T)/n,
             ineffective = sum(ineffective, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("effective", "mixture", "ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 effectiveness - no sig. group dif, n = 414")

```  

## 4.3 Teacher & peer relationships

  * RL.004.a/b How do you believe teacher-child interaction quality has changed for your pre-school/pre-K/K-12 children since adopting remote learning? - declined/about the same/improved\
  * RL.005.a/b How do you believe child-child (i.e., peers) interaction quality has changed for your pre-school/pre-K/K-12 children since adopting remote learning? - declined/about the same/improved\
  
### 4.3.1 Pre-school/Rre-K

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (declined = ifelse (RL.004.a ==1, 1, 0),
          same = ifelse (RL.004.a== 2, 1, 0),
          improved= ifelse (RL.004.a ==3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K teacher-child relationship, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (declined = ifelse (RL.005.a ==1, 1, 0),
          same = ifelse (RL.005.a== 2, 1, 0),
          improved= ifelse (RL.005.a ==3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K peer relationship, n = 220")

```  

#### 4.3.1.1 By race/ethnicity - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (declined = ifelse (RL.004.a ==1, 1, 0),
          same = ifelse (RL.004.a== 2, 1, 0),
          improved= ifelse (RL.004.a ==3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K teacher-child relationship, n = 220")+
  facet_wrap(~types, nrow = 3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (declined = ifelse (RL.005.a ==1, 1, 0),
          same = ifelse (RL.005.a== 2, 1, 0),
          improved= ifelse (RL.005.a ==3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
   filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K peer relationship, n = 220")+
  facet_wrap(~types, nrow = 3)

```  

#### 4.3.1.2 By poverty level - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (declined = ifelse (RL.004.a ==1, 1, 0),
          same = ifelse (RL.004.a== 2, 1, 0),
          improved= ifelse (RL.004.a ==3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K teacher-child relationship, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (declined = ifelse (RL.005.a ==1, 1, 0),
          same = ifelse (RL.005.a== 2, 1, 0),
          improved= ifelse (RL.005.a ==3, 1, 0))%>%
  filter (RL.001.a == 1)%>%
   filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K peer relationship, n = 220")

```  

### 4.3.2 K-12

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (declined = ifelse (RL.004.b ==1, 1, 0),
          same = ifelse (RL.004.b== 2, 1, 0),
          improved= ifelse (RL.004.b ==3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 teacher-child relationship, n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (declined = ifelse (RL.005.b ==1, 1, 0),
          same = ifelse (RL.005.b== 2, 1, 0),
          improved= ifelse (RL.005.b ==3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 peer relationship, n = 414")

```  

#### 4.3.2.1 By race/ethnicity 

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (declined = ifelse (RL.004.b ==1, 1, 0),
          same = ifelse (RL.004.b== 2, 1, 0),
          improved= ifelse (RL.004.b ==3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 teacher-child relationship, n = 414")+
  facet_wrap(~types, nrow =3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (declined = ifelse (RL.005.b ==1, 1, 0),
          same = ifelse (RL.005.b== 2, 1, 0),
          improved= ifelse (RL.005.b ==3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 peer relationship - no sig. group dif., n = 414")+
  facet_wrap(~types, nrow =3)

```  

#### 4.3.2.2 By poverty level - no sig. group difference

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (declined = ifelse (RL.004.b ==1, 1, 0),
          same = ifelse (RL.004.b== 2, 1, 0),
          improved= ifelse (RL.004.b ==3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 teacher-child relationship, n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (declined = ifelse (RL.005.b ==1, 1, 0),
          same = ifelse (RL.005.b== 2, 1, 0),
          improved= ifelse (RL.005.b ==3, 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             declined = sum(declined, na.rm = T)/n,
             same = sum(same, na.rm = T)/n,
             improved = sum(improved, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("declined", "same", "improved"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12  peer relationship, n = 414")

```  

## 4.4 Developmentally/academically on track

  * RL.033.a/b Do you think your Pre-school/Pre-K child(ren) is on track developmentally, when compared to their peers?\
    + Strongly agree\
    + Somewhat agree\
    + Neither agree nor disagree\
    + Somewhat disagree\
    + Strongly disagree\
  * RL.034.a/b Do you think your Pre-school/Pre-K child(ren) is on track academically, when compared to their peers? \
    + Strongly agree\
    + Somewhat agree\
    + Neither agree nor disagree\
    + Somewhat disagree\
    + Strongly disagree\
    
### 4.4.1 Pre-school/Pre-K

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (developmentally_on_track = ifelse (RL.033.a %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.033.a== 3, 1, 0),
          developmentally_off_track= ifelse (RL.033.a %in% c(4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             developmentally_on_track = sum(developmentally_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             developmentally_off_track = sum(developmentally_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("developmentally_on_track", "not_sure", "developmentally_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K developmentally, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (academically_on_track = ifelse (RL.034.a %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.034.a== 3, 1, 0),
          academically_off_track= ifelse (RL.034.a %in% c(4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  summarise (n = n(),
             academically_on_track = sum(academically_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             academically_off_track = sum(academically_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("academically_on_track", "not_sure", "academically_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K academically, n = 220")

```  

#### 4.4.1.1 By race/ethnicity 

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (developmentally_on_track = ifelse (RL.033.a %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.033.a== 3, 1, 0),
          developmentally_off_track= ifelse (RL.033.a %in% c(4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             developmentally_on_track = sum(developmentally_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             developmentally_off_track = sum(developmentally_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("developmentally_on_track", "not_sure", "developmentally_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K developmentally, n = 220")+
  facet_wrap (~types, nrow=3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (academically_on_track = ifelse (RL.034.a %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.034.a== 3, 1, 0),
          academically_off_track= ifelse (RL.034.a %in% c(4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             academically_on_track = sum(academically_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             academically_off_track = sum(academically_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("academically_on_track", "not_sure", "academically_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K academically, n = 220")+
  facet_wrap (~types, nrow=3)

```  

#### 4.4.1.2 By poverty level

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (developmentally_on_track = ifelse (RL.033.a %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.033.a== 3, 1, 0),
          developmentally_off_track= ifelse (RL.033.a %in% c(4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             developmentally_on_track = sum(developmentally_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             developmentally_off_track = sum(developmentally_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("developmentally_on_track", "not_sure", "developmentally_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K developmentally, n = 220")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_prek <- rl %>%
  mutate (academically_on_track = ifelse (RL.034.a %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.034.a== 3, 1, 0),
          academically_off_track= ifelse (RL.034.a %in% c(4,5), 1, 0))%>%
  filter (RL.001.a == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             academically_on_track = sum(academically_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             academically_off_track = sum(academically_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("academically_on_track", "not_sure", "academically_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_prek %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Pre-School/Pre-K academically, n = 220")

```  

### 4.4.2 K-12

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (developmentally_on_track = ifelse (RL.033.b %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.033.b== 3, 1, 0),
          developmentally_off_track= ifelse (RL.033.b %in% c(4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             developmentally_on_track = sum(developmentally_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             developmentally_off_track = sum(developmentally_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("developmentally_on_track", "not_sure", "developmentally_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 developmentally, n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (academically_on_track = ifelse (RL.034.b %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.034.b== 3, 1, 0),
          academically_off_track= ifelse (RL.034.b %in% c(4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  summarise (n = n(),
             academically_on_track = sum(academically_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             academically_off_track = sum(academically_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("academically_on_track", "not_sure", "academically_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 academically, n = 414")

```  

#### 4.4.2.1 By race/ethnicity 

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (developmentally_on_track = ifelse (RL.033.b %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.033.b== 3, 1, 0),
          developmentally_off_track= ifelse (RL.033.b %in% c(4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             developmentally_on_track = sum(developmentally_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             developmentally_off_track = sum(developmentally_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("developmentally_on_track", "not_sure", "developmentally_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 developmentally, n = 414")+
   facet_wrap (~types, nrow=3)

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (academically_on_track = ifelse (RL.034.b %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.034.b== 3, 1, 0),
          academically_off_track= ifelse (RL.034.b %in% c(4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             academically_on_track = sum(academically_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             academically_off_track = sum(academically_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("academically_on_track", "not_sure", "academically_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 academically, n = 414")+
   facet_wrap (~types, nrow=3)

```  


#### 4.4.2.2 By poverty level

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (developmentally_on_track = ifelse (RL.033.b %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.033.b== 3, 1, 0),
          developmentally_off_track= ifelse (RL.033.b %in% c(4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             developmentally_on_track = sum(developmentally_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             developmentally_off_track = sum(developmentally_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("developmentally_on_track", "not_sure", "developmentally_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 developmentally, n = 414")

```  

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_K12 <- rl %>%
  mutate (academically_on_track = ifelse (RL.034.b %in% c(1,2), 1, 0),
          not_sure = ifelse (RL.034.b== 3, 1, 0),
          academically_off_track= ifelse (RL.034.b %in% c(4,5), 1, 0))%>%
  filter (RL.001.b == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             academically_on_track = sum(academically_on_track, na.rm = T)/n,
             not_sure = sum(not_sure, na.rm = T)/n,
             academically_off_track = sum(academically_off_track, na.rm = T)/n
             )%>%
  pivot_longer (cols = c("academically_on_track", "not_sure", "academically_off_track"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_K12 %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "K-12 academically, n = 414")

```  



















